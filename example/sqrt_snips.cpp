/*
Contains the correctness and performance tests for sqrt implementations.
The following correctness tests are included:
 * Hardcoded values precomputed using Wolfram Alpha.
 * Randomly sampled values, checked using:
     r is the square root of x iff r * r <= x and (r+1)*(r+1) > x
 * Edge cases (0, 1, powers of two)
 * Difficult cases for specific algorithms (powers of two -1, numbers with
   limb values 1,2,3 or 4, all possible squares of x= 1..2^32 and all possible
   values for x^2 + 2x for x=1..2^32 (which give the largest possible remainder).
The performance tests randomly sample 20 values with N digits (for N up to 10K)
and compute the mean execution time with error-bars (at 95% confidence). Correctness
is checked as above.
 */
// Whether to enable exhaustive tests for small values (this is time consuming).
#define EXHAUSTIVE_TESTS 0
#include <chrono>
#include <limits>
#include <iomanip>
#include <iostream>
#include <string>
#include <vector>

#include <boost/math/constants/constants.hpp>
#include <boost/multiprecision/cpp_bin_float.hpp>
#include <boost/multiprecision/cpp_dec_float.hpp>
#include <boost/multiprecision/cpp_int.hpp>
#include <random>

#include "boost_gsoc_benchmark_utils.h"

const std::string kInp1 = "3141592653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117067982148086513282306647093844609550582231725359408128481117450284102701938521105559644622948954930381964428810975665933446128475648233786783165271201909145648566923460348610454326648213393607260249141273724587006606315588174881520920962829254091715364367892590360011330530548820466521384146951941511609433057270365759591953092186117381932611793105118548074462379962749567351885752724891227938183011949129833673362440656643086021394946395224737190702179860943702770539217176293176752384674818467669405132000568127145263560827785771342757789609173637178721468440901224953430146549585371050792279689258923542019956112129021960864034418159813629774771309960518707211349999998372978049951059731732816096318595024459455346908302642522308253344685035261931188171010003137838752886587533208381420617177669147303598253490428755468731159562863882353787593751957781857780532171226806613001927876611195909216420198938095257201065485863278865936153381827968230301952035301852968995773622599413891249721775283479131515574857242454150695950829533116861727855889075098381754637464939319255060400927701671139009848824012858361603563707660104710181942955596198946767837449448255379774726847104047534646208046684259069491293313677028989152104752162056966024058038150193511253382430035587640247496473263914199272604269922796782354781636009341721641219924586315030286182974555706749838505494588586926995690927210797509302955321165344987202755960236480665499119881834797753566369807426542527862551818417574672890977772793800081647060016145249192173217214772350141441973568548161361157352552133475741849468438523323907394143334547762416862518983569485562099219222184272550254256887671790494601653466804988627232791786085784383827967976681454100953883786360950680064225125205117392984896084128488626945604241965285022210661186306744278622039194945047123713786960956364371917287467764657573962413890865832645995813390478027590099465764078951269468398352595709825822620522489407726719478268482601476990902640136394437455305068203496252451749399651431429809190659250937221696461515709858387410597885959772975498930161753928468138268683868942774155991855925245953959431049972524680845987273644695848653836736222626099124608051243884390451244136549762780797715691435997700129616089441694868555848406353422072225828488648158456028506016842739452267467678895252138522549954666727823986456596116354886230577456498035593634568174324112515076069479451096596094025228879710893145669136867228748940560101503308617928680920874760917824938589009714909675985261365549781893129784821682998948722658804857564014270477555132379641451523746234364542858444795265867821051141354735739523113427166102135969536231442952484937187110145765403590279934403742007310578539062198387447808478489683321445713868751943506430218453191048481005370614680674919278191197939952061419663428754440643745123718192179998391015919561814675142691239748940907186494231961567945208095146550225231603881930142093762137855956638937787083039069792077346722182562599661501421503068038447734549202605414665925201497442850732518666002132434088190710486331734649651453905796268561005508106658796998163574736384052571459102897064140110971206280439039759515677157700420337869936007230558763176359421873125147120532928191826186125867321579198414848829164470609575270695722091756711672291098169091528017350671274858322287183520935396572512108357915136988209144421006751033467110314126711136990865851639831501970165151168517143765761835155650884909989859982387345528331635507647918535893226185489632132933089857064204675259070915481416549859461637180270981994309924488957571282890592323326097299712084433573265489382391193259746366730583604142813883032038249037589852437441702913276561809377344403070746921120191302033038019762110110044929321516084244485963766983895228684783123552658213144957685726243344189303968642624341077322697802807318915441101044682325271620105265227211166039666557309254711055785376346682065310989652691862056476931257058635662018558100729360659876486117910453348850346113657686753249441668039626579787718556084552965412665408530614344431858676975145661406800700237877659134401712749470420562230538994561314071127000407854733269939081454664645880797270826683063432858785698305235808933065757406795457163775254202114955761581400250126228594130216471550979259230990796547376125517656751357517829666454779174501129961489030463994713296210734043751895735961458901938971311179042978285647503203198691514028708085990480109412147221317947647772622414254854540332157185306142288137585043063321751829798662237172159160771669254748738986654949450114654062843366393790039769265672146385306736096571209180763832716641627488880078692560290228472104031721186082041900042296617119637792133757511495950156604963186294726547364252308177036751590673502350728354056704038674351362222477158915049530984448933309634087807693259939780541934144737744184263129860809988868741326047215695162396586457302163159819319516735381297416772947867242292465436680098067692823828068996400482435403701416314965897940924323789690706977942236250822168895738379862300159377647165122893578601588161755782973523344604281512627203734314653197777416031990665541876397929334419521541341899485444734567383162499341913181480927777103863877343177207545654532207770921201905166096280490926360197598828161332316663652861932668633606273567630354477628035045077723554710585954870279081435624014517180624643626794561275318134078330336254232783944975382437205835311477119926063813346776879695970309833913077109870408591337464144282277263465947047458784778720192771528073176790770715721344473060570073349243693113835049316312840425121925651798069411352801314701304781643788518529092854520116583934196562134914341595625865865570552690496520985803385072242648293972858478316305777756068887644624824685792603953527734803048029005876075825104747091643961362676044925627420420832085661190625454337213153595845068772460290161876679524061634252257719542916299193064553779914037340432875262888963995879475729174642635745525407909145135711136941091193932519107602082520261879853188770584297259167781314969900901921169717372784768472686084900337702424291651300500516832336435038951702989392233451722013812806965011784408745196012122859937162313017114448464090389064495444006198690754851602632750529834918740786680881833851022833450850486082503930213321971551843063545500766828294930413776552793975175461395398468339363830474611996653858153842056853386218672523340283087112328278921250771262946322956398989893582116745627010218356462201349671518819097303811980049734072396103685406643193950979019069963955245300545058068550195673022921913933918568034490398205955100226353536192041994745538593810234395544959778377902374216172711172364343543947822181852862408514006660443325888569867054315470696574745855033232334210730154594051655379068662733379958511562578432298827372319898757141595781119635833005940873068121602876496286744604774649159950549737425626901049037781986835938146574126804925648798556145372347867330390468838343634655379498641927056387293174872332083760112302991136793862708943879936201629515413371424892830722012690147546684765357616477379467520049075715552781965362132392640616013635815590742202020318727760527721900556148425551879253034351398442532234157623361064250639049750086562710953591946589751413103482276930624743536325691607815478181152843667957061108615331504452127473924544945423682886061340841486377670096120715124914043027253860764823634143346235189757664521641376796903149501910857598442391986291642193994907236234646844117394032659184044378051333894525742399508296591228508555821572503107125701266830240292952522011872676756220415420516184163484756516999811614101002996078386909291603028840026910414079288621507842451670908700069928212066041837180653556725253256753286129104248776182582976515795984703562226293486003415872298053498965022629174878820273420922224533985626476691490556284250391275771028402799806636582548892648802545661017296702664076559042909945681506526530537182941270336931378517860904070866711496558343434769338578171138645587367812301458768712660348913909562009939361031029161615288138437909904231747336394804575931493140529763475748119356709110137751721008031559024853090669203767192203322909433467685142214477379393751703443661991040337511173547191855046449026365512816228824462575916333039107225383742182140883508657391771509682887478265699599574490661758344137522397096834080053559849175417381883999446974867626551658276584835884531427756879002909517028352971634456212964043523117600665101241200659755851276178583829204197484423608007193045761893234922927965019875187212726750798125547095890455635792122103334669749923563025494780249011419521238281530911407907386025152274299581807247162591668545133312394804947079119153267343028244186041426363954800044800267049624820179289647669758318327131425170296923488962766844032326092752496035799646925650493681836090032380929345958897069536534940603402166544375589004563288225054525564056448246515187547119621844396582533754388569094113031509526179378002974120766514793942590298969594699556576121865619673378623625612521632086286922210327488921865436480229678070576561514463204692790682120738837781423356282360896320806822246801224826117718589638140918390367367222088832151375560037279839400415297002878307667094447456013455641725437090697939612257142989467154357846878861444581231459357198492252847160504922124247014121478057345510500801908699603302763478708108175450119307141223390866393833952942578690507643100638351983438934159613185434754649556978103829309716465143840700707360411237359984345225161050702705623526601276484830840761183013052793205427462865403603674532865105706587488225698157936789766974220575059683440869735020141020672358502007245225632651341055924019027421624843914035998953539459094407046912091409387001264560016237428802109276457931065792295524988727584610126483699989225695968815920560010165525637567";
const std::string kOut1 = "56049912163979286993112824338688008938543237752107832649583533936522833776518879743363843375245853739417146705744562990455542075539831517566644946677745451618612727648966621311978378350382925082779759505143787044093893128068035895930171543641983336476166511254286056162309665822553855728700099730566135263229310482770603702313599779589939672325828370865928422053430400072831171741334547285379289682272449912286694712173700094410250949077126919778358417034993512788749864711956241169590088384712450761378143280422989405844467629053403673847434253036092763210183618014594581395164325088568787614409826219135243181813696913753386358787313972510259360675479772377361059363688366520927175963963146538161895302181298206700284979643324098936435319236297421615511422632243034067171931249222336948763104805766575786119509692569555110784762196354440111555519991757780200871775142323728903667347543118636354355638087280392848271738719630748047468496994301249912876024511349631260985451719031170479728983056065167857905975608578156028237529803480674118040073278858492101950752173891861660337650836562272708715093157089528406739160931953927001000837904847000768710881398534642244023040032631557613805961341572573677057581517798164957140011417448935726751968198368564231475535369416665704341341361473932163256698986330035924719834067451930226837206672207198012449004735830772927210056948779362683445306451143861751780717406014218866324021093161891297448512843069690455862813985769693620395918155707572635192346267598586852772646106717831994236096054158267859501142124883264259570871295612102513305243390038290986960351100984849179890102968047050810294029374624886696174195055576265785327746299007632671234533056987357385840246475108339516975170155687985566716996931612420541869462899930022686617406827886547069546615807699404544615857283371540248107703435750333997991023066008102628782052797494540694550831826593559165935245881635683817487408902614279571895158472055505948608808814777244919717228149032435608195169318160606323930579370758404408951977877103406675100484676099370652361154793441159560113517547703067477112183171890304600746127572127266895578930896646967267129240094496099189844295503486929488149709653184828992574001341873535594221508804690384051257728958569755139608740989352733051778702401664168014667985797681555252203902549681811763688098028043512684766494182767550698249195747235400347205698113815231055368786043207587240463178284263667634463519002668097641217220167057466201625444982773014539975933330086315899211047864162057867648930550134692340995751448639779094892077147836595723861447226273751318579545215941830738220005150953813310654083443150526197976966241175829522235076964334188658202407818742877054512308861946097457786174422612048857375888309551873398481079998700272873656521970283987461813184953799488890030302460020409194321776727553551779100843317527847565163800755465560414085783206121638349136526315974480385714737258486720942780610894164243990333158685308151157713819751058342785729889585519663748411143665806223114017662699450548750668526851475586382304208361526879405071391549782483426158669829042679314357557383226594561492793530697605814162869195235236856630003177395420633997767190032123469625303485018583169678430891028454228193019491108705324291657363413901167259881854060970863773780817756091238313375862940361778750499836313714984947078351812409691743675408449145009704204839703016833540540064678220128529799413512186487489065336251116151431685114150537204565741151855857323086213971271520667151412112370905791920935310437246728571010412006197006172077562703878832382275231407158894457949763568895263964519959070671786425471277482247950939881475754988336775396391578174605340094853816209638840971454184902844870226532623421447436606466966130257413355871564815116204125061305180437421860424569164687380974883417460171526110638027006434383815884699926940638622101248490620838665556659168593416719767149538544657881139531513005899073629921397571226877055358810272240289674322947084371752073381265238302828731108241982301876829654584612625097689757700926357933785574959099765929962730482183430242377750180754637934705890027364806179569687733063530290780817105166690369228914716616671645721707347431790642437909950837565071936794644578748441560649090182686522029627906546186555002931901536903108103441837302162523553003005321400107679947150870057702184497849602603999313653776174960519308468302958725353003456674412428718255484989371070788955897726474816275829273747482589059443593988828184988240478784109556613577289882002800364538291800578661528346742464641730548385417408899187746496788155360836433185689220102847489668489892258568439250302665777497327222964855119390839115160055071940043820581244657313529834409962760299635655218095868573620496454919780411937664881455084511503650065069475123173222490263790953667954090017498880064968924230577543367763804226203201466440693793348021598868488488273716383564931426176292745120141198013298631705952131544914434428540050730";

const std::string kInp2 = "31415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632788659361533818279682303019520353018529689957736225994138912497217752834791315155748572424541506959508295331168617278558890750983817546374649393192550604009277016711390098488240128583616035637076601047101819429555961989467678374494482553797747268471040475346462080466842590694912933136770289891521047521620569660240580381501935112533824300355876402474964732639141992726042699227967823547816360093417216412199245863150302861829745557067498385054945885869269956909272107975093029553211653449872027559602364806654991198818347977535663698074265425278625518184175746728909777727938000816470600161452491921732172147723501414419735685481613611573525521334757418494684385233239073941433345477624168625189835694855620992192221842725502542568876717904946016534668049886272327917860857843838279679766814541009538837863609506800642251252051173929848960841284886269456042419652850222106611863067442786220391949450471237137869609563643719172874677646575739624138908658326459958133904780275900994657640789512694683983525957098258226205224894077267194782684826014769909026401363944374553050682034962524517493996514314298091906592509372216964615157098583874105978859597729754989301617539284681382686838689427741559918559252459539594310499725246808459872736446958486538367362226260991246080512438843904512441365497627807977156914359977001296160894416948685558484063534220722258284886481584560285060168427394522674676788952521385225499546667278239864565961163548862305774564980355936345681743241125150760694794510965960940252288797108931456691368672287489405601015033086179286809208747609178249385890097149096759852613655497818931297848216829989487226588048575640142704775551323796414515237462343645428584447952658678210511413547357395231134271661021359695362314429524849371871101457654035902799344037420073105785390621983874478084784896833214457138687519435064302184531910484810053706146806749192781911979399520614196634287544406437451237181921799983910159195618146751426912397489409071864942319615679452080951465502252316038819301420937621378559566389377870830390697920773467221825625996615014215030680384477345492026054146659252014974428507325186660021324340881907104863317346496514539057962685610055081066587969981635747363840525714591028970641401109712062804390397595156771577004203378699360072305587631763594218731251471205329281918261861258673215791984148488291644706095752706957220917567116722910981690915280173506712748583222871835209353965725121083579151369882091444210067510334671103141267111369908658516398315019701651511685171437657618351556508849099898599823873455283316355076479185358932261854896321329330898570642046752590709154814165498594616371802709819943099244889575712828905923233260972997120844335732654893823911932597463667305836041428138830320382490375898524374417029132765618093773444030707469211201913020330380197621101100449293215160842444859637669838952286847831235526582131449576857262433441893039686426243410773226978028073189154411010446823252716201052652272111660396665573092547110557853763466820653109896526918620564769312570586356620185581007293606598764861179104533488503461136576867532494416680396265797877185560845529654126654085306143444318586769751456614068007002378776591344017127494704205622305389945613140711270004078547332699390814546646458807972708266830634328587856983052358089330657574067954571637752542021149557615814002501262285941302164715509792592309907965473761255176567513575178296664547791745011299614890304639947132962107340437518957359614589019389713111790429782856475032031986915140287080859904801094121472213179476477726224142548545403321571853061422881375850430633217518297986622371721591607716692547487389866549494501146540628433663937900397692656721463853067360965712091807638327166416274888800786925602902284721040317211860820419000422966171196377921337575114959501566049631862947265473642523081770367515906735023507283540567040386743513622224771589150495309844489333096340878076932599397805419341447377441842631298608099888687413260472156951623965864573021631598193195167353812974167729478672422924654366800980676928238280689964004824354037014163149658979409243237896907069779422362508221688957383798623001593776471651228935786015881617557829735233446042815126272037343146531977774160319906655418763979293344195215413418994854447345673831624993419131814809277771038638773431772075456545322077709212019051660962804909263601975988281613323166636528619326686336062735676303544776280350450777235547105859548702790814356240145171806246436267945612753181340783303362542327839449753824372058353114771199260638133467768796959703098339130771098704085913374641442822772634659470474587847787201927715280731767907707157213444730605700733492436931138350493163128404251219256517980694113528013147013047816437885185290928545201165839341965621349143415956258658655705526904965209858033850722426482939728584783163057777560688876446248246857926039535277348030480290058760758251047470916439613626760449256274204208320856611906254543372131535958450687724602901618766795240616342522577195429162991930645537799140373404328752628889639958794757291746426357455254079091451357111369410911939325191076020825202618798531887705842972591677813149699009019211697173727847684726860849003377024242916513005005168323364350389517029893922334517220138128069650117844087451960121228599371623130171144484640903890644954440061986907548516026327505298349187407866808818338510228334508504860825039302133219715518430635455007668282949304137765527939751754613953984683393638304746119966538581538420568533862186725233402830871123282789212507712629463229563989898935821167456270102183564622013496715188190973038119800497340723961036854066431939509790190699639552453005450580685501956730229219139339185680344903982059551002263535361920419947455385938102343955449597783779023742161727111723643435439478221818528624085140066604433258885698670543154706965747458550332323342107301545940516553790686627333799585115625784322988273723198987571415957811196358330059408730681216028764962867446047746491599505497374256269010490377819868359381465741268049256487985561453723478673303904688383436346553794986419270563872931748723320837601123029911367938627089438799362016295154133714248928307220126901475466847653576164773794675200490757155527819653621323926406160136358155907422020203187277605277219005561484255518792530343513984425322341576233610642506390497500865627109535919465897514131034822769306247435363256916078154781811528436679570611086153315044521274739245449454236828860613408414863776700961207151249140430272538607648236341433462351897576645216413767969031495019108575984423919862916421939949072362346468441173940326591840443780513338945257423995082965912285085558215725031071257012668302402929525220118726767562204154205161841634847565169998116141010029960783869092916030288400269104140792886215078424516709087000699282120660418371806535567252532567532861291042487761825829765157959847035622262934860034158722980534989650226291748788202734209222245339856264766914905562842503912757710284027998066365825488926488025456610172967026640765590429099456815065265305371829412703369313785178609040708667114965583434347693385781711386455873678123014587687126603489139095620099393610310291616152881384379099042317473363948045759314931405297634757481193567091101377517210080315590248530906692037671922033229094334676851422144773793937517034436619910403375111735471918550464490263655128162288244625759163330391072253837421821408835086573917715096828874782656995995744906617583441375223970968340800535598491754173818839994469748676265516582765848358845314277568790029095170283529716344562129640435231176006651012412006597558512761785838292041974844236080071930457618932349229279650198751872127267507981255470958904556357921221033346697499235630254947802490114195212382815309114079073860251522742995818072471625916685451333123948049470791191532673430282441860414263639548000448002670496248201792896476697583183271314251702969234889627668440323260927524960357996469256504936818360900323809293459588970695365349406034021665443755890045632882250545255640564482465151875471196218443965825337543885690941130315095261793780029741207665147939425902989695946995565761218656196733786236256125216320862869222103274889218654364802296780705765615144632046927906821207388377814233562823608963208068222468012248261177185896381409183903673672220888321513755600372798394004152970028783076670944474560134556417254370906979396122571429894671543578468788614445812314593571984922528471605049221242470141214780573455105008019086996033027634787081081754501193071412233908663938339529425786905076431006383519834389341596131854347546495569781038293097164651438407007073604112373599843452251610507027056235266012764848308407611830130527932054274628654036036745328651057065874882256981579367897669742205750596834408697350201410206723585020072452256326513410559240190274216248439140359989535394590944070469120914093870012645600162374288021092764579310657922955249887275846101264836999892256959688159205600101655256375678";
const std::string kOut2 = "177245385090551602729816748334114518279754945612238712821380778985291128459103218137495065673854466541622682362428257066623615286572442260252509370960278706846203769865310512284992517302895082622893209537926796280017463901535147972051670019018523401858544697449491264031392177552590621640541933250090639840761373347747515343366798978936585183640879545116516173876005906739343179133280985484624818490205465485219561325156164746751504273876105610799612710721006037204448367236529661370809432349883166842421384570960912042042778577806869476657000521830568512541339663694465418151071669388332194292935706226886522442054214994804992075648639887483850593064021821402928581123306497894520362114907896228738940324597819851313487126651250629326004465638210967502681249693059542046156076195221739152507020779275809905433290066222306761446966124818874306997883520506146444385418530797357425717918563595974995995226384924220388910396640644729397284134504300214056423343303926175613417633632001703765416347632066927654181283576249032690450848532013419243598973087119379948293873011126256165881888478597787596376136321863424654664133395435570320152265419395218603049731051382949843965916561424595542122661510247853609809551039560078940218809961338285402501680074580272911936642519282051000193635007391464329549343395192885373545920056376650288054057553212318900912632281915091498083669562448310085222192397364632484286326114576693242537157737789441409054457359535122562639108023923690973212790580761713460391457479187979412485021844514581134188888041322095533218464670972749102856526270784545326222784880098238583630075495095476406237708338835722543662156748132766838424497242087451616183320507799148018466681423669365190284546385761482785703777438837629747998273770543158368241099868322850380552635536972229313380526442841037231204396700430761245413831179227827536371559839837688453702784298570709051122384053677901338541458531620807304313806973998743669316601381707927205604195488285806309311163629704786781402696327296270122613598589775450528948311301668400153207485198240246333755585171356801934122897598071956874025057150214178379254364303036592821125092588061890311707454312790395355366068261100118896574204872759391997699553835211508669625559644137050382924495359031063623453056471711621685872545868744002961175792172319055405719868172758841908964965790669651560172835148290385655116980721079533091613084359852438946544068216550032753799602386650379888648152118657999585718656377511331597475359604341377664511914346013429250811632480640907377321262933574747296767934127160296651208098980905779966030510218162555797890748707621107623802626785429701502710915350498535149239083248428082898759557567884889260842088552126951035737020866125911554132044037356086433883712396206429390237866631163261678884192279819499524039424578422044303042043042071096927339294608510496928973916185560783787033642890234293271887296802972158165942612972836639590504113037474574350974905801632691653757690981097485625377850342879942192237718584431832793731298006587036861923010217454505203084553303861950660236433411532059741224264265354216558150036472691946382544124557259473900719227187097960549897246028226024291050774020812375674807627637743706345046314773769480331683570762058749578173350996762873387396702968819066142614457371322822803935444608377601058646738943855776887203971767059273166300903112608144884308624114292247965454026163755158658735198437217550552729506415043576875838149359401055659121503770441973880370568097143463163605434136507669997576211981184258742252081404364062117230919743945524596778174219146433350671463646225947923194970034966025635210337806603805270316524545464736406208302982734943367284773530202247052900995698156705864039885636834956495288287851964475557425601459926852581856308538058155219970292348029482179570039295476876737874675614745450525851711675415202826622799977038693342250012297731621239492462707583316806464073929378457821418549833278676481879256795013284511260015478829830397094122795590273983121481454227018426602478198104333377295840025838886567683453330902961094998749374134782736346821466102487373043493685735064797943663991366663660331913993158766562151616291771186182321657000846588579387498935708365390051442789307831998499981759325614412462969595617412625709879433827533850002535219448835558926174974877784628872249292595975180895929200656041663786736990873762713624049521962477786393579372886317266994704386641622616372576966921423095336415578106880243876225565690957041111929329419336352138037692136273833819830244199702433009694861871085709025954822085641199104101975680270188980749875221764846725695738526974653312988267258169188864563262749529655208476443369725290231293888886172298365388606288519962105545717369008144991518103776264256672840522144402197474662350151152362302177635204375528607776725412022934171898265399118147904685922433784252070116245217876908741620845115578154869546824111382745732829225060159722322499657545023166289561501837132083717115348063673894";

// sqrt(2^10000 - 1).
const std::string kOut5 = "141246703213942603683520966701614733366889617518454111681368808585711816984270751255808912631671152637335603208431366082764203838069979338335971185726639923431051777851865399011877999645131707069373498212631323752553111215372844035950900535954860733418453405575566736801565587405464699640499050849699472357900905617571376618228216434213181520991556677126498651782204174061830939239176861341383294018240225838692725596147005144243281075275629495339093813198966735633606329691023842454125835888656873133981287240980008838073668221804264432910894030789020219440578198488267339768238872279902157420307247570510423845868872596735891805818727796435753018518086641356012851302546726823009250218328018251907340245449863183265637987862198511046362985461949587281119139907228004385942880953958816554567625296086916885774828934449941362416588675326940332561103664556982622206834474219811081872404929503481991376740379825998791411879802717583885498575115299471743469241117070230398103378615232793710290992656444842895511830355733152020804157920090041811951880456705515468349446182731742327685989277607620709525878318766488368348965015474997864119765441433356928012344111765735336393557879214937004347568208665958717764059293592887514292843557047089164876483116615691886203812997555690171892169733755224469032475078797830901321579940127337210694377283439922280274060798234786740434893458120198341101033812506720046609891160700284002100980452964039788704335302619337597862052192280371481132164147186514169090917191909375";

// sqrt(2^i - 1) for i = 1 to 256.
const std::vector<std::string> kOuts({"1", "1", "2", "3", "5", "7", "11", "15", "22", "31", "45", "63", "90", "127", "181", "255", "362", "511", "724", "1023", "1448", "2047", "2896", "4095", "5792", "8191", "11585", "16383", "23170", "32767", "46340", "65535", "92681", "131071", "185363", "262143", "370727", "524287", "741455", "1048575", "1482910", "2097151", "2965820", "4194303", "5931641", "8388607", "11863283", "16777215", "23726566", "33554431", "47453132", "67108863", "94906265", "134217727", "189812531", "268435455", "379625062", "536870911", "759250124", "1073741823", "1518500249", "2147483647", "3037000499", "4294967295", "6074000999", "8589934591", "12148001999", "17179869183", "24296003999", "34359738367", "48592007999", "68719476735", "97184015999", "137438953471", "194368031998", "274877906943", "388736063996", "549755813887", "777472127993", "1099511627775", "1554944255987", "2199023255551", "3109888511975", "4398046511103", "6219777023950", "8796093022207", "12439554047901", "17592186044415", "24879108095803", "35184372088831", "49758216191607", "70368744177663", "99516432383215", "140737488355327", "199032864766430", "281474976710655", "398065729532860", "562949953421311", "796131459065721", "1125899906842623", "1592262918131443", "2251799813685247", "3184525836262886", "4503599627370495", "6369051672525772", "9007199254740991", "12738103345051545", "18014398509481983", "25476206690103090", "36028797018963967", "50952413380206180", "72057594037927935", "101904826760412361", "144115188075855871", "203809653520824722", "288230376151711743", "407619307041649444", "576460752303423487", "815238614083298888", "1152921504606846975", "1630477228166597776", "2305843009213693951", "3260954456333195553", "4611686018427387903", "6521908912666391106", "9223372036854775807", "13043817825332782212", "18446744073709551615", "26087635650665564424", "36893488147419103231", "52175271301331128849", "73786976294838206463", "104350542602662257698", "147573952589676412927", "208701085205324515397", "295147905179352825855", "417402170410649030795", "590295810358705651711", "834804340821298061590", "1180591620717411303423", "1669608681642596123180", "2361183241434822606847", "3339217363285192246361", "4722366482869645213695", "6678434726570384492722", "9444732965739290427391", "13356869453140768985445", "18889465931478580854783", "26713738906281537970891", "37778931862957161709567", "53427477812563075941783", "75557863725914323419135", "106854955625126151883567", "151115727451828646838271", "213709911250252303767135", "302231454903657293676543", "427419822500504607534270", "604462909807314587353087", "854839645001009215068541", "1208925819614629174706175", "1709679290002018430137083", "2417851639229258349412351", "3419358580004036860274166", "4835703278458516698824703", "6838717160008073720548332", "9671406556917033397649407", "13677434320016147441096664", "19342813113834066795298815", "27354868640032294882193329", "38685626227668133590597631", "54709737280064589764386658", "77371252455336267181195263", "109419474560129179528773316", "154742504910672534362390527", "218838949120258359057546633", "309485009821345068724781055", "437677898240516718115093267", "618970019642690137449562111", "875355796481033436230186534", "1237940039285380274899124223", "1750711592962066872460373069", "2475880078570760549798248447", "3501423185924133744920746139", "4951760157141521099596496895", "7002846371848267489841492278", "9903520314283042199192993791", "14005692743696534979682984556", "19807040628566084398385987583", "28011385487393069959365969113", "39614081257132168796771975167", "56022770974786139918731938227", "79228162514264337593543950335", "112045541949572279837463876454", "158456325028528675187087900671", "224091083899144559674927752909", "316912650057057350374175801343", "448182167798289119349855505819", "633825300114114700748351602687", "896364335596578238699711011639", "1267650600228229401496703205375", "1792728671193156477399422023278", "2535301200456458802993406410751", "3585457342386312954798844046557", "5070602400912917605986812821503", "7170914684772625909597688093114", "10141204801825835211973625643007", "14341829369545251819195376186229", "20282409603651670423947251286015", "28683658739090503638390752372458", "40564819207303340847894502572031", "57367317478181007276781504744917", "81129638414606681695789005144063", "114734634956362014553563009489834", "162259276829213363391578010288127", "229469269912724029107126018979668", "324518553658426726783156020576255", "458938539825448058214252037959337", "649037107316853453566312041152511", "917877079650896116428504075918674", "1298074214633706907132624082305023", "1835754159301792232857008151837349", "2596148429267413814265248164610047", "3671508318603584465714016303674698", "5192296858534827628530496329220095", "7343016637207168931428032607349397", "10384593717069655257060992658440191", "14686033274414337862856065214698794", "20769187434139310514121985316880383", "29372066548828675725712130429397589", "41538374868278621028243970633760767", "58744133097657351451424260858795179", "83076749736557242056487941267521535", "117488266195314702902848521717590359", "166153499473114484112975882535043071", "234976532390629405805697043435180719", "332306998946228968225951765070086143", "469953064781258811611394086870361439", "664613997892457936451903530140172287", "939906129562517623222788173740722878", "1329227995784915872903807060280344575", "1879812259125035246445576347481445757", "2658455991569831745807614120560689151", "3759624518250070492891152694962891514", "5316911983139663491615228241121378303", "7519249036500140985782305389925783028", "10633823966279326983230456482242756607", "15038498073000281971564610779851566057", "21267647932558653966460912964485513215", "30076996146000563943129221559703132115", "42535295865117307932921825928971026431", "60153992292001127886258443119406264231", "85070591730234615865843651857942052863", "120307984584002255772516886238812528463", "170141183460469231731687303715884105727", "240615969168004511545033772477625056927", "340282366920938463463374607431768211455"});

// pi^100
const std::string kFloatInp1 = "5.187848314319613192086261524630301356268676068040578499007184235808218814439170444889750694577840234220453514273665432055250648488062737295897743326942853518489226036463275640912414105233574469107006909063758829988327772286235184653004574020656452816754267777841064495630056840308799849357951544577638436715255994935018953098968295067735270017423866020508947547581125440353150681300412862966322339713880564147947133139698624248157039717516564399036068820322010782540713658271284133099091867781485218583241593671865056248901085636591733109162344459808448050800243647227135033147863074361420753783980433256333701818617451516674232533258723397998618085260503011580786053607082376814176666447972660311787607766256882693062371345309571027248688223991629763362497446625193567201996398099867065804897830848880890113913778390891863518938963370549134219877305621322752720005711540024563015676021317743439928554310249592282037789636609733636802441813666494346825483253604449298750877797259997400517295566286849003005765398465145704362317360484763567774330393456074463908120139880849498945641421012301625536266808647923704595346154821392745569078962493595346525819496658741067946942177941315023534765452250770187224961473012657310020239763873653971725673482428868872021792206996389763108872322417108864859280207912703572019206992819305703481576736932229745403296488303776045910892428421997534283553684062747055682553769326226581381389808431845612689647705179260423116020637954227165235663957129197716176178357613223385229539582425989832717760002962622176656671520364404474952294389390345047663148347475877919544306261816377108993438390279192923000053876776917495233344944121081640645573940263275624862394949340296834340711492406598225170814546565245413700342826053179692040686038445962267545476325061485672731400770660037060307659779543252081756371032150915892388809207731307868840287017311379956711924072602162690872002058385500274476849939530403024785861267243697642480383625691990848972566348291969590898089037701346634079557983055034815644230160545616734908739082033896411284913376065362809486776744507910683465308333361144384555039815297939896082395348481078289235253437677614810543741594751984692443722739367860067720153549068534303247950160773804398627613135125359913063529752458132554841473914867139667369508593419986790898724488189175540621382884806858688301956584390639494221903888571083598044336766928886194562969190546089729828666849782782083508805727210118529913657071835101284801604197854556314863497493003148758390269734244447532414643792168422723614816755810803587552613221739996156131939292678966469648665598005466589890842574589547055757334739370362302864183178744934512036993456982084722844007150424085278167403183405336853840663491149475348841996489419677726965408977490234900317671638893633525954809205089947045179555807872519024338428619357177883902842179813650774869813274693855656314128259666824343902551370310003580117351761016689503619368980347860959599470372359680918073308869734286826171719929913584309188593118531475044281047990041559286642939060159064477801796075900735788582431426468182962547633415158913353417674524307109534831184819308486565537464664078179847137398118314510752645078779782737621298379941072134819968457184491279640296399141791220377272958155858326915174223689560542751733975793457991401451540708198911079720752098989309911219105187142289464627684895370715422771645338441022240949996637238512514141538056855849879622938417137253604944513002453995654487419428821368673139921641816535337017331983254445015516207357785766189639340059658817403708516924328637908902261477082879298231018246240261451977420074465981946535454575451292053091569267534410178105120739778527965946627380964818752218013230355399200028265921116671975130343332915037418863220112740839489294716414279360928676256702370262931209398199086444017969043508951903405538898225093585711344440443716606203066237371740868123754707560727881710980459389812460627669062922221995811668715448318600733217469726342989356846989901162546955677601674525950139089922542464917455293457528971745956263351254636817239654025318375081601434738871855938177879724652343242096633036091657519044167647883111991423452948156169276375428099508181008174614373052527622245065884876715557059065346684678448736057786935464327370344836019327713910043241962978790932336806209673076050366243389457487093308558034823268134317257408252016116529728514798054972977493466484451735199849013017701497217241176293425471406673423747856303079437537908336148114305159806651258474225136002896596336929079444005922428322487959936742356420269605030565817404931938599369510497176813413337257786487675651750497889516650365028897523244006815785201228683434304511253413238121896339030424341141379868611149002348269593425018954040670482152331146756405769904306638300832405457071838073445512506373205184762913421085591399043475089134056211000534753823525508570147505465369454450488989016016202453148349528775906889782997622349902185528578703162821198015359728365863206438356766642770818609098593627932399557016309893757616749241524990078056203695201216621397271875408428143035607986945897024815592303350467914166875174843964367560856685923735827058446549744504408377709879534610641387825080497276406226105736616548255762635356661635665507464754381073438603798238637576821355932500167877349154277631772474550310526226441376597308894144381423819864186809197552984259697168081597349657372690711527208490140399498561655154701341620659552137704770385968066808320086635063472070880322657718304312614520236196137248560391390068232072925670323866055952433514570689734660822692269228123384095135140653464708275365110123227489867245400771065782478109341123554861922606797338633026518286359130951032719657403626111485282482822561084612199188885808357166324528764503384768028368787959838696690393323509087603329915571741804486206660498990522039260747726232180789055134675595218583764479963001014692028242162915328130315635123655466805443468203131960964210213595399633093001856389279446217592900200059971479807176457250874147197507549307294664453222601769901036309846527622733413506482762877840007115939040790525743776248094415599027525509307733765014640483512655839244056021374334041717920709843652800781055736105411051885665060181361755963666739473385495800225304836754073087689201299600436434034876986238717287666720388907693547708814795840477323692763172458836035967259798919328113437639887213040301595155091699549084297839202707516971651347935097746852088388144879531512967204855584241847521298981641634697472804179119978615300561716995874424953030584798280951659749056083655800131481553138066620112421676723262712362598183451447306291626663319325404642045012082165707174549117492979489834059002058896381018320225935912468119291473910069011300359814270729191650165931740582083586784608025180303802462519981904006944675737214278015019135625472138710370372725552634605924090887034737271898829782747694230003309684349254250015831576166253924770208908308689257751484417787569505141428006611855626657523161994066127972970000195305969179548623838192220516291967889550525959810754889753944301708048168009603883384150871983232966857800095122350206323881095793243455617602094629079576602002204299056573540858816094076573950993125248027126358113254756105086622044057591221734718321213563756811868665682664620604719459898392914408277103937501777077676056599805953928900929230406920301378092600125933225716462377165606753839548645632702837048460168100565864268962064121343918424966155041696758309128422434802036715172290313457068439298170416933363481764911054108039961201927161106708450706798206389361131456835131932741929141092218020431647772772426895549485713772451277898600558774697789026526325932730804307732937465437241428546804156640479832912517346381375667648772490907693276708904075102246090853956124651427892570815058297606979741203688881105414888885396373916202967181922865378721044529323761659091100702016942210940177640793495860826822369050784342575272143767601081151920575139347474196956559831998620476861003181908399115368258178980516553053590626000279501775864472627853875140581872786141386107389642333633703703237338178448275491018648658382768153582659428949407267959100566826879831044880982108121864428557504852401362441147673909892301389773175688962540050355415299092088972120591081665325055407873311863878379846688111955607087370193362993379070655699203078237354087159980196391001728887387033514466547933176895323104311875084759735529485033567709735668543706035128003314501240134615041994371844452319970422088456827013785148120137791694571691710549530277564140350959200133876870370608345291617403425095826350012187197630390624198433751481530553777473555586403384002682834994871074016168332298707803505234410540598940309968328984459905603560198465305669570999670643307551978188488281105361714215034488583483830179232059488764883478042489354130001371080687747903162775253818090903207359702938871302688911991177186574769973552285506237689411095858178612153692315662243893859626765551481258437822877650187440838286156183491743036232809003035616513844593957881692206909353183595874478529246363898622732496720120734637351677376984370079828581208368405280030133153714875555186890076761741200906151444949165181285337375398938385723569520379914668048066408635165588912356344667435793463262443242000885551500694691284681041478222924833983561625819191726117021703957362277449337772016625087023228821605407794778557396842504361249665741471580639408467548260486655855385711915008579266204800212760167503293279974543367771622436372335081090788871295635959952100474691043344922607900683246523170996946902083809669272944278330647635765414655380184241195795668227805685719271246985805236502072907408278872081037023259117612613274238359521924621091424807496130858934868729820147232660867102039650579050945878917422449370961107397946805673806048712285710457430305305014423042535179794501317801140218300243939408791257749469808928821951952104219254848970884334950584300187863e49";
const std::string kFloatOut1 = "7.202671944715803306364652672351423475419361795240633867221932517136580047759951329927662040518690386132402707813250445630972447316777639898479330614266158263555202396202121052336356319931131243135796598758311834453368565148952018573595554932698033356088536725818136399412695789820853115974872268201377974605120486000213353192377069842244567774689931484869270557881291033083992956018744127709818468313940632475405867309130872861923864331939095167416685016262998757555430039104089929041932573755540030097292780725844254162301083715794285778373906492354713235838394745264880738911961940423795178117455354978488048464093237865411227320930604729135394587940204196153150076205540767010957311089639107899160359368350532099660226652341713198332330559007189458186703724239915525439755202585454150680016014348520947008060060797011032212957823287947621105362752559204323660472879616444147258308480086784905350204459135024130393379366800654054916653539835777918725881244698180015341549079269738988143104828271228530967701737500790256573392652485240123675479616597254240804663706871465841690499393592988613335938222965819678543389616005892993598648782716563670144866850416113940077660209430023981000265989474481852121879639336471638993975276018803564406068083801731066202657219927041832870223477558772538346107153393623361356222100024681526602308187471045165621997809428941274827672319518670693476316711402474113964637732335521217416901601083918590128186965605247869506634662011268727147187514881272742868263205590567231693624928229359984933019139688700310652939284746618290328549767465574094213200354100538619032178414515297355994962304342301219447404709690226336296074075004032687242139743784570009007981794002875946573016525098807461537720253097916313043533948850715457816807031469475515323936342391402665233197943866058178643672560516589692571601134379618677941559708920283485993047985676697212802952980228139175534699142491739356610811319949436218324592778281455264678107206401680744458992703892630155490089633722076242614177499802294898368946656996100034166325978337732920860062323729787212793287307936895963406581371047592393960841547016017360073631412398755349434184571269178716600228566789222965608376691234117184590997673208394717987573242913082028304010599514246692267831520306544852586318146205804842890650209168564010991257794711840523623355907176962456176970251260419533839547507914305159817743704667914243268251549381451868926566798406047223125933096861337453060145560534969103113084320483735027252161984647642388031657168702489175785678476079190576287127552811134771831949964910148815165859928658207382386681123896962282379132849738715923577795439624948169792939871293969860633357410275142995815419647708328470797060810663098082577071793440594270572456247038062495427068056868216243594846330606881483759250007117536630143497107292314369457310939077877583220226186817296971962164899542484602130344885108159622305169638364701817936716732153944188531192450438349986566422564468352096870544998710781157897019930904992529658237444314500441583933712174319305100241278081508071372354560594325568231791965618217128748227180639845737652167197104599514126778261236516914756518753896335717895556441399519216015849762310932275373789056609253618108899731007691457339672284980242758287066554839551448552934943093548879713629999605763137825388885661495118566299844421801884902147699413409777180868786560877709031413344125988914195339883936443710103003430041956481750293960629096508874171540647333547037939838280234449378455181485348466144820599669178025335873381239282509497038773286268599232689155075358953943534493705036307354777563767342306526352355337666103210908358624548599548973104216556391907581903931730126737179085036254120544472371934008925434923901891377327582554528515551111249838381704342044042137049064756233729919212274569323572618755844976298252852957069855572463417433194238311764902429159840858776905092283840567911168816205935152469563075144955581002961757451678202285191259298298872403788963452962985615995586065131178580899769915542825299817464248711568640938909728547376652506728379478624997448298846898335339663205256262287708340347258805092284948093716405616921167608224953330409343124806177293142440921749937550053886080485453918474048742941114114852330864408293778665628586624433642831634556539084870470113224021918220587163059048674450639580501035626272987326131448115832012883994192849050748759167650523995708611742108795606569242661597631360434379063591432993184944791938844483811450441453807429166694519216180330570107833855593797799353224437420095646488370529650036414392336797145920034495349861474987277330151750530035938628836068080730724825748800404550561823528530504691904985639510479552330624305690226911373255159844442763987152922905050940242895165148857874595352029838008102246435958989188458876985538692628204692191558703061696576016572945701855539157551996860305462047477656316804749351706615687057067764477726105311791361227629530048643536547642137047100284670154684752586746111881407771004920711647819117289258034615588969216422617031544152000416252720569479698114089950098813638936949668344467409904614265165058362406324902473770838962333888050517257040898799438960756057349768611632798410455360143501020300286386945194019965206769045493931838574594792248129099885827068376136399310702595416137500193921695947216301814078041698382602868772597942414351874481297710988796091738087908024876526669670523064714167711302465929511017483368435554805103788728016856384349997687935409058238253918892174441559884571234558916937920734693940062233176531134100795823425260774041400707584005319419748337400468626691485123538721346895681395873711146893382276859322633805372826177755519309177057035028363223518064921411632965121625896462411121979945620299616697030087918104754880335828889554875363959831950518487449345261213733617198821071797649987054685265736121953493429167418901263058633936004347424449449401199834321749443933548865304913857686215444578276915591513939612093894885016058559267479242738002271760311057087098554864408009234008687283271544194683893705353207520936143828834015908313765279538746360492795471630801782544959409788315215315282769851645084095936602517975700598545793114712416295986889471084913813585226568372178072661279062611373456947783898542891464566499782710780198221041038767299380046502603269623501991000359989160541311975671497806985941315191285664620433636941984822588039231795584840787884321568263810837222162678654496581411035904669395397306934074259725032209396058546774563543334214909060760377127243149156202901623389440364373765924852914611282286052616432639118268727206760144692445777357086967556470617543807451500591236364513521716817199771566127854417227852196789800361676092406884764703713403057069867619183242656412255362391496519705628954856407996889612346722707895268463991594488498456247001557513022408537934317889639116620823394022137649053759026506674347801636068620115461862557777384420500403116818591200463534912365743060834876768420900320825702985555077773832776707864253357395625545890109377046327526769451850034485900182053690917992924574600659005176734776488650236384201419447668936003280984883497286998412872354727528763128377905989087629095871075796501528398454282676763832521465443691189348337321875390368120589031087383780373201314893341672813252831058435306578182571748400587910953320163635938650087974801182872251908472735019944362669737342786609714858918519984139526240640175918429997374799024501737657181109400278820201112939759778111124438324081285605777984492159324411043395225381681765039780781834579991286113761798724503959179590389582674443686945632231478479632514061123171007614821633374465626530827827939799021911460992547109715772853908447386497722061395907917700770986935376703554996756222331026029775101140191170134127724486167502873670368495063085234556481150876999821918583236911706010340642780332447167019837043934170717203722230467726732455478565327693591855135079252497903620407708741631895499126754417744381291262627834094024805232009130887385854750257778901878066279458620610279817043015510580882638814618942756518247245225514318148324311854408642267103797130928529517580050683176349714293883972789900413850561267848146504096185976248738857663526753475012211088093996887209064939482050384396993548817371269568696578579433018106250578351736977467292417830367966875082700884042577756066932096975767429866486698864384004629334183869504904319030191117064316574153875796264766111223472095682226558291109824562567810839483992185576926396602957000058694146762013521864878178264847105838617794359188490099008259436370451367446327717089195102178452250487945806396082614391263988651862449361784054007359703623726552616363138587074461562403740197890802070507023959492104269022511844600794580580258237749079870656407108522167959300631701009697758667868604429622594334941481909679304051628583043609123866936268176968555245326524433611384995181078073663976634814046031139976919694403096446386659924565054577141933885668888159497362601340993951481446397063180119943093685706518191736981070660183857418635064270455480687581850579445233142731153453119322695290611460117973393378181514073888640080784136234174273868583163287542723970956215380815104158182043195881217368497431440480776963725019808444329390765442827315783993706746186112695245475451134951652397422326835819451378723477023038142069862633015809872727199573869281548594192096249838779161428434448765648183042589065742455296714829981900449570014200800947783522649066828230061501930165579875232158005056072346486176393240108052870597727180650559579046269225049518354530689701982253240735266924678413205336587906229592457116156299609003358380214762434943638343664866368532656025419707213248863136651772656866994153825480407497616523663693899411162529760939138571088787798632572261018743152445770291072308184548275588088945209124852045304789705434228870375802331348793823510433802694963092330748185991714000345797394193754024181503455520720348602939379919297826517e24";

// pi^-100
const std::string kFloatInp2 = "1.927581416056012995951327177483949526461624469911701380542710070146189722835692505142686246618674549493373717005998983428074413128056926214626016623432390334501107185938658279620159691741006567721499318628072210729636234367980205696200928948281433941374851821201365760752224883740764535404378637988552549683373899575260568404508084164893335142924946723288966737379087669332341602119565211215241157270188231680649921667481609509281443709540696412202340094202837041222942312913111145726616418847868829790744862939269835168454192920305705203899630766625269206708827503874994617756916226395126565385807296996600060729000084739208686499757274200741413499207157584579741609556939605080671794679254287953704750536999819430306181113564656815172159947963257745018213014437322414987162216320825658081332340993799901748543501647366677580488697050881083439518381100979177815574993528702802879869635197911248545645488188316058631524962269510001158945868005401360825910912437824705206003006582869113453386170412052109919526035692371647587865763479611074809558760593977233024379214594081009628257368743259775593773045941086540194018384490015889341132735846814072067897759462285015966294975268878855119639034366753414644880059534546923604852942480977416284926279450599918371516110344468064162657290869088113087063149088975308737181259486580703431871641495353719358783899828527434815144843988329827644941560109853746099918422145971554041007969916450854906066404241654300666448334196360211852203658535000615588514579539956937996160185400235579225536364037039577658244912079123511175523515947846724258038935455412760925355582809846403030136186339277826178566563467021617205501404113039349692492499895032989459259212474735691509135894025250426808362298128888799706109129386014901580827891020360841013191455128258967255385025770344092336068229942983011734534782463998918366322520130540262140329517957204125512033416565674334908292629005678227717525921011675513660693861970601406979903240708660247955557948344521392109340090378179244951462107476243196811909235997781260072139473866120281238480521661821057028873638395225429303427994072730806185844566633784647240155132531470284396507566922324701191783045317772343251972014233933079716714940175843741585721690475574577777233899737405148702653800534705675657291833604080799167555970395688447403493243972468632311982552775616812232257113777045622829662017557331672786999888905954763970257523853711690509103778363022735378111425574153887901076299723711626600588898502168290584940355443481950696339916654634815087745235174271308389773008805095075670226347580631795528991649792746941123529310792141887850650353002675538696966038230808951934376045543244584012910579610300985583245915852081704988981708168145282277367372439650519628041221696550813378937781224488010063831932438618902398067047704890098615250190426871396499198115930804619496540594853624465366877958538738252300837599067938493109830624430131036249558023664343798124794975769712580206679460297654694558429339206585297286007274774144515741509823115876292358653677937982851829035635429034402399913706749343891795254006917186096147346332884988391225878745462089533407186570391099418790489664757157125757491065556178267077470389530927850733240539836618437641048785256068865581847803234199974671423399939733891022103262586689136651184510424185740181285907391438340073618268317744602708794042422323663712988585125882309051835790304490659227506929293394456455363710700337408326952161472356201773936815176580117041221298515745881006752110309910838592624873572209956098480434135367003872115188416484131659882986932436000265915671528052959956365688896109221475782130765257316878552451294952431618353083220907559933034010894784807385311999110524498483668850699329014159345927553942504801261925946377993650232816618138789860235905054176896067225243813281169442133512243665435820224584586431643903614739183294036692336811762312231796372968126240635849759249905348153497717618818338317315424980514483189449833648193519956962403375679045548781218167680894161565552659653541941643711262508588471893684843468039092840735010453338495917439912028471742283526190468799311113845138065732734607962095369201026454324407005545276900105294078741114308664162691776480099147261868676031013290741336533461744034856699435744245797778548022719877129265013285243433419674427699568810992474054311048527184791801086059678846175035554040192507168795945422439152618314952128368564323926581171373211388518915771409771548659632264409052628499824747167105079120822287013721943005836511113882782981360906519526106270978742474325772970082573434905939638933852344660436864797816446158255364828270982149107389823426977148946190532172139077940510746201779820339207194357933755368395944714531052199144384420980182469175287393645495620833669384579411252430625170229245017398003117483841414715197022502493078326242923127338550702965016826034808946338049138646024904964424690609135173135039255637825544555125439341605618401459877432273522875293322830354620196733883536798967657021595315254781015696426148916930464833746632162924488685254919767949274563083873397441320551369641731567019601132247546092167546694929136945208090106423094091003454228202562793792453451446861306725773543610204348820073587176789374802881131412860416153311911592901623732953340879586422267929098928517143455783660713674705997827556229009683360540353997160385110521015109462794745841256105077923462341610239718938720993390407886838322883150625032807201737070379746224858342801579319755508113808062673027398114286515558745330598943507085320030904617013739905033938524264680897719718844888868540149532715044689195823911321650054935278177886386933131354500942753966066304603116573367959466085203859229132015271447846977745390349404484591942176175111889426557909825453378169606147675764625428462200181981930844246818941178334099422256130870107530545726915030206894309210622922872431954673761358230703642795810690982207290663697448829700248648069279893080124971306178529235010781901965455741367155296273365244189823718353520217353821614470626859576558928898668817309751245801626333612735175523923154794806743899515264283117168595047945443886738792696575866930600798517846623624273614932921496689156304036300603506567380471210975179092673112796381518147519876982455599019324003561702048572438343451787597485102173267795589383075577393517104788094363273134729570952635568419497896991938816236447013053498092043988239618648261604752963036164641418991964471562741310124727956221944079202799620216218569317855863870826613428045358783354807201684451687770541822897418571779048355923272687870105075221723860742855452119307131556455536755795786136172961775102895984278313412621669069175847614895432924522248170932543249280273174985759957080224541342351273722724584547454707658913939592854462024938339893723809705629296948892619242504697016383387412787998079712106400270592178267197386549241705278762527181844786872597691641444699423244010400721050683203329547365358270202047647089838277056611442464760834612492469745137047235883468631366424979704801916696728347202373428844843052456095906319810672720015219531736729598529583570949211335473019755753041842138324899399834356664645340427620155900256366197842255397514085587159716601296285791301931640961498368456704862343888477384406068468208077452063778298794549486307128312942144016919725247769243006640002584069986077118545898081171573354338229608716157401251757996952867878957955059612097462923536189441120050959414368973324196915726473550981515681658464038282774475740148484476036108244144273507521814007509404912989626924781682728108842042726910373006195173446270634353405838331667640458002209613194492243890729778395835060863046573993942807509256309492400070724095684174944066431517359712219215593616824730592901968465688696357104413715097123845401979440312999039398066331189212230819906183561830206625768832041209476456729567188603333725839574389936173217455567184888159660295411108694585448316840512083750067775763891652703944783478391572944150078521304018098103927874394045232180659588460546727212221899725804333509705157765734785386081040051305112970084732961842885016152883397749461541938016931457545336636338648712109694378044792078484977189467718986180741987100261031561031887692474383819752183452364210660685901208539859531587210447928849642335733251051511615239582571158066403399049830025580436607705768310913539996626611067331253698610985390150773177969402716445979926432901458148974175993160258059314051589862858809515865767942446564266488391753793105198560120733835440596906878878236539852398943889826344519227932388399445416021569582665961497884489984013216324073151652340720748705517964648519908409393596891897991803080111238965146715843906523782708409831703851808739109785384847159457416486720425899628267745087707719694567933186026350860670448053107690251845907243174524081260049866332382864290219360453619328116406516985309852432770711783760824160666713345051482499095007987477197024298150659037250023378745542522648229600990383369264327256000587195005460642185812724816236312413724441377135099131137688425547413722254138828402357650020700916531422957709561243728134402845482304330661578311870257617586784989179173961898647855438022116293133625943890678242145274679399514226713969922314541931071808647257798386037544371968188057123326693001548199987257830921755808428404076482552281038597182424320598850932129494185563159229254285382139536938342552608257270023268187956941255702780151969156843533469523440750932170972317597650846245570991609200944152276113934182335169838460182545204669111364100395805287686182333347162276048160208504280900803966101744867449031199628476621512329711230282130795142962013210309480023459566385880723618210199480819382014867043579774471621743784601312149970429313697815064350232578425677418872880654596329355510693427144399294460612477578587621695167772704593053677923787964941921280591574729240693415572854519799095277652485527908174958716108599888998994772101865076227519089604791553071643877373091e-50";
const std::string kFloatOut2 = "1.388373658658220508933796314904904257431244351708309852920121964922408287407112277661219535838047013897756823736148804934133683137324423715417453222332703525845385358177749418826273895312803717260965679564686334083751676759905285620357884086423788639073199760325376431166547984305772977317434462836628110327778859529990982264333406701617180765530377687270871056930066524278931937782186064282450741257661079030513257151821017704805990508383746330118442201114571606419227809883045502630312628239594908722687866692262051824145769314386665790134651909810584844781468012817872489130912843080321024387299474376799559535098845387593200184052603511959456282296048952536617500203835586411773386979002854576843020060023784426652520058833316699241556032926283554779314853007337400046615349099586075058857859640053274439771127800389658772886404120979227335687522880244012755729830568577858323593768139179624236405538145541308339782642117894396398189021181126326214040305252660969530062949528388210882959436985518821661273145064627503436449372595364968604380494111598899536609076651658840392032904081656043208942753659693209390046403938214488727993295695309123822105277428138243224882858827352497678985075987469446787023674603045399094449849775682280412327769936704586137325287002109058785369198415305000252802242251093725401360308624366089638478406189892930916125394854019293289224104481159301676182181183988642842385337959569659281464713309519940034995174781912130040175092531997934703169123961606054909526657696082300432968376493003651472998668279355472876887310196416558406788008974732177899496299032494112857882662869556517393772425052716548094388554119928095966237173123331540080189738355616434627568305343339412590262548405341406524592688797007559837358269114708904909593438318895275840164705198905595907420351575127711421755889210513913963023246571604560166072556131719816637024006384692488651944618722251526220641251100388443590355410772337246353420017822646154806710736852018412158282814995875185375503386129278219006218101197694362384255635715625936322926184500324070071950323552659620041439952963775843660588742957146958136176539161956256932975292366274832399657982928412454383835149399750993737465278079514774814470353285064461681538978422810327743877219237538654175833848625954509034197162753491134569599049547123230946752580556485067559869042756709722220050220469607252989224601168358921940053580055316866563793944290889852335095876504644165773240860696281907664005382925250332198407743237937633700797982269157701775109596232224281403544964103331323241211682361675132942315514946360566431618257428844482186047508617675078535851940132717107738997391214585998647115851373858375530084423105370081418942074388398618881991780626373392111457447900857690186857106300014951444789277420190481915621467539012467884592932713413258098264358553773543385894285765428746890589498239227590432516361747838475956104361287490987285895143718482675313321816106070144843797812431467359553693332867990032722418860773560755568614510957741545153929269711732678615329732760851837143263126814639667591184906891831304614979406415516473677227332737036701169983206008142471428317496508070787822102877545878949682410765039353002137552585144017156455443774245225513261087558895448980090593050032842927666394887107530402189286951087299605178714900083577416552567403566407435615202194522799739893379459374835226473488573126435058850495750808481300412283307325816194519686668223631724016595288938228147335575634918591057294537735644384526223929276871634713755790595305236978015073524959469445378896360834887201197945409186358913130858150216205923598260256843882024403540340654200503673934700162755282723984227347391337935279373208073489413877041674200699465910935276153374037905300037398255827350203626488378432742962829106048950066732571054671805142203762213761489097582126189057027076384482429274549912726362408480550714427552711114155081795037938301522748085330804979891596194877831220449314192688996786988760231575741475058265623219586037918477380971092938824267856924508728230646002836514855862327076801580389816659028051889524397238550695162655357724319257955344643998940347208808800580377504767429216278898719471758621081608928162382900379802267058505765864021291373564065077264644484126970858027161238138525912050771496942631731173639482895196909476177382414586725262040280936519333279338638368754744905791632217777242086525326748909205045825372872246122431114559467948798482604895246695349686675825916640985883156850950381478948832773003355404546867687417985678000211410470235189546452102013643663540647271564149092724121376606522794827383976174952554829301114907567329593552665173222834671712144316069836204855960205723567079595280627744782804798060710798890782544760534223637084222386851335593676704199025284829176135873050072583890650306991033105185241427361054547651964747277764992827681422179820960432127177356064881460976343622671724985810215428933016842825056541989911362572365707430106057308062445545751896636567665322046829100572378735542055758816763742066739595897347772633874372780526700958445684103923014054978149846472686459104472005124609750837014086333938092215316577557453206657581532077394603102249191322890936514132239534972730763142720119479278810043025429768769359704494835321150674657195193793991505695527223134955096931435971745039393755368617205536112090889272284440095565316026824444089475274876128720111318844074668425834417535283001370304349886509780087121723821500441555978046312163364139948347844110803402164050046000582181413226189843168287661075029836481894263752962573489808943177614518191913013693043477349002026127704274850667874600787598187665715103044702762755887354540656744160754400625647486853612342341663318051706420632889697827869063948296125557062983187966523125979341011503756571555733860566864330660869014238790285976544871625068708832420091936369208829819657186686826077771615724901512518569973078704543758247053731050810326779053081307895783082226671716815438738358267136109542680700599980317363929762156629088314181510742664524200263045573231930310831392266899233252969316297585068744061808246701120402919925968527698434107288395735870138546502749759657848692141246387927331201057426274625516955759894586874649339727679686876890802368845569924054102613147413839079956162537922322264530912314116985361833790803136104316304179797942547110749282351367983613713808755035628577747363610060272412102304349435390361928584046998700644292463035527879903525500298022983851013500708556226708819761865519728142768410909145651945896199117351170519585894552786839970237351336306887430722189200338955862299520490635665860692442016421432737748200211757225806304659332172390004696358479613901008990407161394306319742951690357516276889018423808857701195926155103226892632881084091806418430654289860855735967805608478100096729845165868112107209631214857622384188508411412647993016936621249455567082943739213405325151864733494874272610197999548393352503933954890538655340413581155844293877341503552684233523473091788411517724406803940574160248107450537722003736203601899753032414385893340384823217111925148792195299885724738972259043466763441627442819645642510779312345749920511010998220687245090887217245590201490737127018374160454659052234371040901323056561489186069635112290285625565500914203522418501239984094133819468376898807014955096240389542280587036998755162672505242606758685031010542779956036263051408470878473159939671313453584344847304839823131015817469661970756831960865629234211074839699176037385237000006021601594124244279566384318774209221241441500120980491860688232876474198120682505008903191367017356030821178059923765950942744887835515771675191870193838421723869788410250450313053503253521574880083748516681987565517830757775750829359372445743654372471860139734123365661263919574955742373946482907417613409606239074766473942441559652725656995822455609622019475851399302292033933874979742379047520979132307821573095472500201393029058721628399613769091603077374031651610772942097527545227045204766495683896682489439767062687120747478207425039650555553776303812396548806481103511097800616921156205924850969129502479301951592338427971846630714829616682331019185556879245729835283969544961550162046326471887643793135698164342215046091441474748566838505711423191330197059169685441940240105410278796778531935552887107764732766338809423025823673605346223507087057518870235026568111925141311780199420016321675703757918392659177198152895745892697053811249591181315765525303479955907459395927062493851476195419912398329585895615167484132860181891533493091606720523427516735348609445412748266508113046570695704949107727745619721567406325884028331502857989605559190627792268214740396013190758489384267874542961818418519819174158225270963669830446654817073982323536544198990475476086789174776580840170542968960007723073525694393346727544116717152951037036524709492925663851677512998776979283205006551955973633887318093149926053194119315625244869404759143704807981948160927880276609936966577035015322996589153569412179783778597801778916689153342898385549484653894433358740083254756679424908884288695668731583016908941752879352404306757222872632372762213126856366408702291840883701316497205111608931762686167571710903090388507172347055493740273368989128028877283766716453900120857642267578462363215530385472017493951232654231561834395104177748376811417422526553624003479182432713237838253329922951760639178305531847238264067513064097770427706563136351259628412115822449232299442235829504742612192324902745861911791185582559055256335311571966525302104039851473377956751222559754138049084134988097355957815047704788290152031236009765864067680654503584384536106943290802352224149638104113242204954718744835235192560692139750218630712171446538070805912318442730620871466414922878900097555306850057946174310827176075214292459355731876875426064851954627007985467363341112069126395350546852733493995796759081375394366950763142052000592019238634867865984023217867534857933844159451815999023407542602974e-25";

// N[2^500 - 1+ (2^500 - 1)/2^100, 10000]
const std::string kFloatInp3 = "1.2676506002282294014967032053759999999999999999999999999999992111390947789881945882714347172137703267935648909769952297210693359375e30";
const std::string kFloatOut3 = "1.125899906842623999999999999999999999999999999999999999999999649675383918795732269067604177520967179934514530871057060732874525666277224205634779652884943916346935749300823275508159341866062519382518026995201382391462920396179538310116720885903733302738580560521554897684404359586712794327435134029585069063227260754295520657108911340358393154660556570166634028133674375010317813606206741302407187239184719777936931777968492453277225476705976274409542609222788339512347015940258183912483463288987815585238323036810558343978524235048545560576810356025977126960412336057899874608392612021447756386801996697400993075700107357242120199022619446328006730997305595880457623335863733947100088681960070959407034321696425339374310093989625982674246220965339126006484392736603643617772807812239396310239535224719752282869030355680652265231892853741218104461123170803993355587277452870378271310255207602624418476525288820654531481608583546568300009172615812950536327011028111259932959755582987271637496911500279447454151422922840950388728320577106431370287205844191061729696871062494524663460748234208229120764462292504259314669690246328565045842741849033894613864114524258485919911135059979759172084872481203323261934157820903440399690888006598517389184179109183235871815610395930822063729094900943936966983776575057434440299656117420401158069318465443421460698637346418726668798105702928244779928754785118553386101123263903077946652093807609463003321545105200182518502673453244701328094964151785549557301832642274482259317340950061613764138699323624772806820740238809189776154316997700916920029710156952438026771922504747486608805447844935024372216387651510126369129565799156898031676953875085743422030305629395854224350787969713457446446185705601245087492225461554515532463184675084712625123122710207414389243087119513146011824976596126731287386201206779651940110705967016969878075434436496275827071018930232702128984433565223514023403194724492187289277835242951915956546462104060532475484795762008475570096771743138499114854208541475891626153391819507714302313359918065498894998119096576213375525295615719874992897108265482556257746289324836182292955518952191872383985757012987342099883639171228465290747757674875003006313250382564382484534600372428346510648870075683287029233699159311562716170538957665839321063774619636218464354552482134881906141861877600991308831776677309231072647246678009604494790498404889950897056866457552270722114697416033335437838922395099687944651518010692319433947991788617925862649086795122205605388413839503048918548152732073543832671131637235336696150732670636712840933403414086612848791853400586311876112591262741350650475289620949854948105747984747835421112156699379576228928195762380070362062529059418829164138219674246098326423770991861029287287067815464140501185179989899494577348739756940222320630027979480236841131225667218773513923186670748246745176161969948174751439335886759075970215054077444862641717252151840003488365689874635547316296638073022537922022292084070192053574910959666602614277161340029577255033269414579365264921640846241449738598842613109362425592243525494542268332343337975822786932151102524634992420683877962943112581614837710822307273730561460231638179536097699930706059875954341585453071201949577040496392743384709050335489443968285569050122547048338769074001945286169100944428105175935831831212300088691785130902867222848870823164580698463052739720804473212344235143809968897185979889964140582389100546687782694576622725865057719688616422091037571000170664163159698005392610374396347665589161110500781146960758087713017828616450371084045586821684637718887494842261859779339509612073833674640981863684830005818186473803438337979004823897663367670384930043605844802258073103760825272095838651620592750615448329165871279053450471364777385974554943177539771724552811811432903536439379442710765891381556289632221394071137931697475835019145427152075798440952863009579023883785955925994417097005394229785732567866581102428460104534602259579831795285461433584969292740215392128588287674580774186871388876888469963669635613648794014744388946135759098467344567516927689315604060728319539695820789905644404815607282867283942657430389164148256693436591653052927064982525453327918079401712163811842641938548182111577238795376672999980214786045514803051745899355546497997318561466280971724794856594095508150220556018773169536332357425111335003482012105015476290024541784178865720619665025419159465352166948622080967115291318521778197260693423722356966929392774414190103115667306744195506521902043082569076004921439185432064397189263720100991514879304277013116832852815374846587913897263806086618107440177946107021674699595842823830971402188953634978380705914865665512587390081300576576413899942809267796300285830773289064654790882148476699990159770639059117783943332352823634842288736173066685932676203700641417629746925757562474339184316382542228335075562752410907839591941159431527372054129837369493274915428509522934572944375519553426323556354912547646252547734567223422054858433255379266087833353501944904269635823717331699083601665705752520294083385448013699596364675726632907102824891974041932904729365667822960096552871882300521277744537578689887534784359912261280128942849889753871591048911226184441023880676293657565783130820949843485664391089424667162554881087490517073143106193021632684266740570144722155567438428777134282078731326722428660854190286257032192978242166057889144923656913038641799034394455815618996910837512125073060674748712521312813833118864564336804357902921536017366363427110414606075945601629442015596636014576965211374715694932450128239911731568992748294749018236819047082444715128487887892326215423995113557205586332475620539298389255250672538189258371099602535938733580758753090967802769941956451541470997080289785983138916023213644583524606566125245454020837195984124826646834336969088651242327249223116569456863964350365674756410537074892116684318412723779927541380634007883937663256674335594752416888665870676218574231785988373113001395501047807289484556391914580722525332047298228477886576864169116318318141194772733314483441440080179253478332253087336893302947353866187869370757977380157045610639546440568524384989087377373624765082475708371772072264403159796971143503735649779075977598033107294331168409959505395561313371179046533422644890404285230382032004462061616041908071990471966212806759384636255656738796344214953200614919914112403082227797673590913033910973672029643971528512116807501153213495801592037712657035460862097022176914179204494644695295809100957512140508766703636762552487966020327159462115340699210555834199345035583526502069467907944895510470728408840444615584246319927996676213362112709658798735950430056666965328992407606123552393638615880416253998088801650393341319818960755962256101468331858278478371034029759315082649973767626731995981282727984005239402902538830365930377556885406936963473404109463820514933532392773300433808845000642243519966343203386734292121155413953334011797544989635895611392057399890179036591217905465053203254834495178115802080115939077076652645238211006559704657322631903568280083618662824439570750262717126073111420688450845063297260357771755820110290007964134841548665478234558983046206590965502662781844998711455680717616048771110831084579834820834214318723397470390264420636038142112068733431223310902609966707752998505672467388040720964531596649823754324730486718971758925572673990168067736412706020181898412272473761669423382182333496475690183341598456980490158592497919913446997003760670924766134053667166886726298404162775521219217714560986904123631674260702923479896922076563760908468199112689797265027287228528875840294925434156662277810114439377472820411826550220228402967979389438087174652025096210754039210593494141657167287805082847430036788547585795786743888652312456237923871533043603066380670295920394556829781591249633777517618242513334622704376129485112476215522146405261524020076066868846627216532427649638789005459721685067771026229260927506429324368547482002790475414348391235918617924608667499359189024171015598761813222696343729551814282101052225024500765294959701623381177285088682359307131694087209749956785930155874707542990796456305456773291320293461616581635041692616140723548593769234314357528895041192641780891331237088508137876299352534225425767087224264489100199941138422148533217071893042555633173487034036052496789404867379489496920392403975312422290072352829288626977581993534156962290911749339552814250707774980015851138930760546313729639963053143838664921030883373653920528879802408465231788638790871680414338378888155527840253501545042631994183844652735229099589250513113482958713851018831510246156813319848618499205644844235858503125379106616236733958641267916714958158735963009696399329688908000599032102518254759948233748503422048861780862181338810274265407520784725704717065422251121008349425168119668828193815302647064321478715263533665631805314355895824575390912974770849724212661356916768055190276424032946072127008376169226305863726330696205818517706070233885923765046141076506729169858366121206731915027121838647476966033381984822275304459871791108059868197668891594722778399604755887089753460762333434669990067122738588164236491220984909423831963697621977094869684285526038789115309398922718801611861716843180004769328119608271566463902948272399049925209515974062057805822779168084950095874064945600917590476657835247174783351261903122118304133381751879910166566426732561182971833133338959005240014883599252793730714096414129538565562434711362662925946567587921162064723358656350607759662234715793178894026063565157095254539420110334308990022533518983975722379269101490233070763439798328652256404306621802313323990790646879162147902264799571933515016979196723812010581173844788309677587580857167939932185901015286382078459348422849562422290062645096923781459612758651225534149239171600848738139885849501048392982706715368586683222995414868464297171706441880929497724053620392016469453124608693769660288564843597564104981e15";

template <typename T>
void run_sqrt_test(
    const T& x,
    const T& ref,
    bool     comparing_ints = true)
{
   boost_gsoc2020::stopwatch_type my_stopwatch;

   my_stopwatch.reset();

   T sqrt_value = sqrt(x);

   const auto execution_time =
       std::chrono::duration_cast<std::chrono::duration<float> >(my_stopwatch.elapsed()).count();

   std::cout << "execution_time: " << std::setprecision(3) << execution_time << "s" << std::endl;
   T closeness = abs(sqrt_value - ref);
   std::cout << "closeness: " << std::setprecision(3) << closeness << std::endl;

   // When comparing integer square roots the values should differ
   // less than 1. For integers this means that they are the same. For,
   // floats it means that this is between floor(sqrt(x)) and ceil(sqrt(x)).
   if (comparing_ints)
   {
      if (closeness < 1)
         std::cout << "CORRECT" << std::endl;
      else
         std::cout << "WRONG" << std::endl;
   }

   std::cout << std::endl;
}

template <typename T>
void run_integer_tests(bool float_checks = false)
{
   std::cout << "Testing integer values: " << std::endl
             << std::endl;

      // sqrt(pi * 10^9999)
      T x1(kInp1);
      T ref_x1(kOut1);
      run_sqrt_test<T>(x1, ref_x1);

      // sqrt(pi * 10^10000)
      T x2(kInp2);
      T ref_x2(kOut2);
      run_sqrt_test<T>(x2, ref_x2);

#if EXHAUSTIVE_TESTS
      if (!float_checks)
      {

         for (size_t i = 0; i < (1ULL << 32); ++i)
         {
            if (sqrt(T(i) * T(i) + 2 * T(i)) != T(i))
               std::cout << "Wrong " << i << std::endl;
            if (i % 1000000ULL == 0)
               std::cout << i << std::endl;
         }

         for (size_t i = 0; i < (1ULL << 32); ++i)
         {
            if (sqrt(T(i) * T(i)) != T(i))
               std::cout << "Wrong " << i << std::endl;
            if (i % 1000000ULL == 0)
               std::cout << i << std::endl;
         }

         for (size_t i = 0; i < (1ULL << 32); ++i)
         {
            if (sqrt(T(i)) != T(sqrt(i)))
               std::cout << "Wrong " << i << std::endl;
            if (i % 1000000ULL == 0)
               std::cout << i << std::endl;
         }
      }
#endif

      for (int i = 0; i < 128; ++i)
      {
         T b;
         b     = boost::multiprecision::pow(T(2.0), 2 * i);
         T ref;
         ref   = boost::multiprecision::pow(T(2.0), i);
         T sqrt_val = sqrt(b);
         if (abs(sqrt_val - ref) > std::numeric_limits<T>::epsilon())
         {
            std::cout << "Wrong sqrt(2^(2i)) for i=" << i << std::endl;
            std::cout << "  Expected : " << ref << std::endl;
            std::cout << "  Got : " << sqrt_val << std::endl;
            std::cout << "  Closeness : " << sqrt_val - ref << std::endl;
         }
      }
      std::cout << "Tested powers 2^i for i = 0, 2, ..., 256" << std::endl;

      T x3(0);
      T ref_x3(0);
      run_sqrt_test<T>(x3, ref_x3);

      T x4(1);
      T ref_x4(1);
      run_sqrt_test<T>(x4, ref_x4);

      // Triggers the if r < 0 cases.
      T x5(1);
      x5 = pow(T(2.0), 10000) - 1;
      T ref_x5(kOut5);
      run_sqrt_test<T>(x5, ref_x5);

      // Integers with 1 limb.
      T x6(2306419268LL);
      T ref_x6(sqrt(2306419268LL));
      run_sqrt_test<T>(x6, ref_x6);

      T x7(238526429LL);
      T ref_x7(sqrt(238526429LL));
      run_sqrt_test<T>(x7, ref_x7);

      // Integers with 2 limbs.
      T x8("1162620140663400369");
      T ref_x8("1078248645");
      run_sqrt_test<T>(x8, ref_x8);

      T x9("2664568616535085527");
      T ref_x9("1632350641");
      run_sqrt_test<T>(x9, ref_x9);

      // Integers with 3 limbs.
      T x10("26984781090246209473137499070");
      T ref_x10("164270451056318");
      run_sqrt_test<T>(x10, ref_x10);

      T x11("15120820810748369907378255947");
      T ref_x11("122966746768174");
      run_sqrt_test<T>(x11, ref_x11);

      // Integers with 4 limbs.
      T x12("322641423992404147943656864513128071623");
      T ref_x12("17962222134034645880");
      run_sqrt_test<T>(x12, ref_x12);

      T x13("40574055951553183194429630201912946772");
      T ref_x13("6369776758376480433");
      run_sqrt_test<T>(x13, ref_x13);

      T x14("174950723329530435889705323158024850783");
      T ref_x14("13226893941115972972");
      run_sqrt_test<T>(x14, ref_x14);
   

   // Test 2^n-1 which catches the edge cases for overflows.
   for (size_t i = 1; i <= kOuts.size(); ++i)
   {
      T x;
      x = boost::multiprecision::pow(T(2.0), (unsigned int) i) - 1;
      T ref(kOuts[i - 1]);
      T value = sqrt(x);
      T diff = boost::multiprecision::abs(sqrt(x) - ref);
      if ((!float_checks && diff != 0) || (float_checks && diff > T(1)))
      {
         std::cout << "Wrong sqrt(2^i -1) for i = " << i << std::endl;
         std::cout << "  Expected : " << kOuts[i - 1] << std::endl;
         std::cout << "  Got : " << value << std::endl;
         std::cout << "  Closeness : " << diff << std::endl;
      }
   }
   std::cout << "Tested powers 2^i-1 for i = 1, ..., 256" << std::endl;
}

template <typename T>
void run_float_tests()
{
   std::cout << "Testing floating point values:" << std::endl
             << std::endl;
   T x1(kFloatInp1);
   T ref_x1(kFloatOut1);
   run_sqrt_test<T>(x1, ref_x1);

   T x2(kFloatInp2);
   T ref_x2(kFloatOut2);
   run_sqrt_test<T>(x2, ref_x2);

   T x3(kFloatInp3);
   T ref_x3(kFloatOut3);
   run_sqrt_test<T>(x3, ref_x3);
}

template <typename Generator>
std::string generateRandomNumber(size_t digits, Generator& gen)
{
   std::uniform_int_distribution<int> uniform(0, 10);
   std::string                        str;
   str += std::to_string(uniform(gen) % 9 + 1);
   for (size_t i = 1; i < digits; ++i)
   {
      str += std::to_string(uniform(gen));
   }
   return str;
}

template<typename T>
bool isSquareRoot(const T& root, const T& x) {
   return root * root <= x && (root + 1) * (root + 1) > x;
}

template <typename T>
void run_time_experiments(int factor=1)
{
   std::cout << "Running timed experiments :" << std::endl;
   std::vector<int>           digits({500, 1000, 1500, 2000, 2500, 3000, 3500, 4000, 4500, 5000, 5500, 6000, 6500, 7000, 7500, 8000, 8500, 9000, 9500, 10000});
   size_t                     reps = 20;
   std::default_random_engine generator(42);
   int                        total = 0;
   for (int cur_digits : digits)
   {
      cur_digits *= factor;
      boost_gsoc2020::aggregator_type aggregator;
      for (size_t rep = 0; rep < reps; ++rep)
      {
         T                              val(generateRandomNumber(cur_digits, generator));
         boost_gsoc2020::stopwatch_type stopwatch;
         stopwatch.reset();
         T ans = sqrt(val);
         total += !ans.is_zero();
         auto time = stopwatch.elapsed().count();
         aggregator.addMeasurement(time);
         if (!isSquareRoot(ans, val))
         {
            std::cout << "WRONG" << std::endl;
         }
      }
      double mean         = aggregator.getMean() / 1000000000.0;
      double st_deviation = sqrt(aggregator.getVariance()) / 1000000000.0;
      std::cout << "(" << cur_digits << ", " << mean << ") +- ("
                << st_deviation << ", " << 1.96 * st_deviation << ")" << std::endl;
   }
   std::cout << "checksum : " << total << std::endl;
}

int main()
{
   std::cout << "==== Running tests for cpp_int: ====" << std::endl;
   run_integer_tests<boost::multiprecision::cpp_int>(false);
   run_time_experiments<boost::multiprecision::cpp_int>();
   
   std::cout << "==== Running tests for cpp_float<10000>: ====" << std::endl;
   run_integer_tests<boost::multiprecision::number<boost::multiprecision::backends::cpp_bin_float<10000> > >(true);
   run_float_tests<boost::multiprecision::number<boost::multiprecision::backends::cpp_bin_float<10000> > >();

   return 0;
}
