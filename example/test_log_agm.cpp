// This program includes various correctness and performance
// tests for logarithm implementation for different floating
// point backends.
//
// Correctness tests includes:
//  * Tests of extreme values (infinity, zero)
//  * Tests of edge cases (1, e)
//  * Tests for various pseudo-random values.
//  * Tests for different ranges: close to zero, just below 1/2
//    just above 1/2, just below 1, just above 1.
#include <iostream>
#include <iomanip>
#include <limits>
#include <random>

#include "boost_gsoc_benchmark_utils.h"

#include <boost/math/special_functions/gamma.hpp>
#include <boost/multiprecision/cpp_bin_float.hpp>
#include <boost/multiprecision/cpp_dec_float.hpp>
#include <boost/multiprecision/gmp.hpp>
#include <boost/multiprecision/mpfr.hpp>

namespace test_with_boost {

template <int T>
using float_type_gmp = boost::multiprecision::number<boost::multiprecision::gmp_float<T>,
                                                     boost::multiprecision::et_off>;

template <int T>
using float_type_mpfr = boost::multiprecision::number<boost::multiprecision::mpfr_float_backend<T>,
                                                      boost::multiprecision::et_off>;

template<int T>
using float_cpp_bin = boost::multiprecision::number<boost::multiprecision::cpp_bin_float<T>, boost::multiprecision::et_off >;

template <int T>
using float_cpp_dec = boost::multiprecision::number<boost::multiprecision::cpp_dec_float<T>, boost::multiprecision::et_off >;

} // namespace test_with_boost

template <typename T>
void run_experiment(size_t digits)
{
   boost_gsoc2020::stopwatch_type my_stopwatch;

   T x = 10 + boost::math::constants::third<T>();

   // Compare with N[Log[31/3], 10000]
   my_stopwatch.reset();

   const T log_value = log(x);
   
   const auto execution_time =
       std::chrono::duration_cast<std::chrono::duration<float> >(my_stopwatch.elapsed()).count();

   std::cout << digits << " : " << std::setprecision(3) << execution_time << "s" << std::endl;
}

template <typename T>
T relative_error(T a, T b)
{
   using std::abs;

   T min_val = (std::numeric_limits<T>::min)();
   T max_val = (std::numeric_limits<T>::max)();

   if ((a != 0) && (b != 0))
   {
      if (a == b)
         return 0;

      if (abs(b) >= max_val)
      {
         if (abs(a) >= max_val)
            return 0; // one infinity is as good as another!
      }
      // If the result is denormalised, treat all denorms as equivalent:
      if ((a < min_val) && (a > 0))
         a = min_val;
      else if ((a > -min_val) && (a < 0))
         a = -min_val;
      if ((b < min_val) && (b > 0))
         b = min_val;
      else if ((b > -min_val) && (b < 0))
         b = -min_val;

      return (std::max)(abs(T((a - b) / a)), abs(T((a - b) / b))) / std::numeric_limits<T>::epsilon();
   }

   // Handle special case where one or both are zero:
   if (min_val == 0)
      return abs(T(a - b));
   if (abs(a) < min_val)
      a = min_val;
   if (abs(b) < min_val)
      b = min_val;

   return (std::max)(abs(T((a - b) / a)), abs(T((a - b) / b))) / std::numeric_limits<T>::epsilon();
}

template<typename T>
void compare(const T& val, const T& target) {
  std::cout << "  Absolute error : " << std::setprecision(3) << abs(val - target) << std::endl;
  std::cout << "  Relative error : " << std::setprecision(3) << relative_error(val, target) << std::endl;
}

template<typename T>
void run_just_below_half() {
  std::cout << "Test Log(9/22) : " << std::endl;
  T target = static_cast<T>("-0.8938178760220964706886852255782544586022258726521735258698590513489786594457134949336865253715893013807771487767929527712050809424928783102823694009016292057760439391422837974210203088731080003326928732874599619083451028003042415809833218250412569827325744750911061141167297947871568667000401725246402024902712895118195865319492975487714415975698081650819840479065122454514663461330570298565465151477020966623366219272485322923694904307438828038260195646621352235901269314030695659965982260484494210552095929748961520942478482089351081295125338386898391234888662624934262008204449371177846980077238979134242972154418229890770765534875239446774425500755144674915575224078641057806494244293476558471225874496159458728961668709399326994353222592789209787406910461951634588879807265220458835435942311943184480708765194897159324103844117320236994217313317944278614829791607196358736384878117666035069326906191192197426080808919170771634265820704285396816206945087484251768098454978387862991273585670935219051006807849359316809844387952948636119142028477167367231219859421041571273984942030212270460768000173462904756018002773189919104912494491495706141859697380776960826301535778602540795980174626708922831237263681386377526104566525765065838702237798859410546785920288378093165243064572921655628309865545624866813562946087097341074505591362930303725993494884150904584868705052771496421378048614170634795061140173316543932772496336730481332086037578982862453607326837002233233626320802250625310219737188940483414775810328317122831378646662427873495015464776554163469488141248649750945923782718462798035869579308010063057465286708101722289303937235428215884280806022069360154847192067527222486949972498831852422402769680656578109015092024580954295999860126653171773590062555429936859147393891773327405048048084664846935748381822981036792766380637250442230321144892492992110906854296009173980094207784268259149370209573252940376978099617096717966884671944259022177572964528392660715030976230765334435309921663776198709342579767099216441373583287117748882655514001279479206539409520399850472802963118197921571901713192190548758435223213602941096318451334381368814073478846163297137096682682698064255178316666518868404050084308442095065676865458427790673612133111322644431471259575997837317085470047101199299651147487691078388523027307547439582488858069921412320480672572792124403123438919163797662841184130592170172994515429841781390989918457952861606250820959688291073120576592882964043801396543455636262053026424112454641625053655714582292051397606391339112237474635008229715583891574446730980282381433844359953529195714177122489868626930904371897976048321850751945540108937394833616980925882561895644110424163536767242944055146467891341741605772153130683593640767509986622854386369432592415615795326113136927455140856300178067089438890645946727485465427831432821759583816495890673531554307660176890597037222474664922412547243235873187633067921918623532730038851419032475978320162384539968086860722636357669907254218001230590106621807488697153831985670656958125492684998322587137706251234691055805353346454882342213609201613315202748947727201456869115981706920461068599502623357600208572589373478535384124135740019570306386475805416264595213041147387555241041148261273331876595506516143442533037952453979432899224960284244545587292319696284578575673809114107029620619126813310455759945087531027726575105442813598405936170210850751997068852590589816350709814178469478045658944690505038057746462533440370737861571729743545734024154636067138603512321312881756456224634751235224892690214188015906520623592376334588487180150606504401414461405780566916187963076153379630556409305566942573324232389297363814367837983152509739727527789743532689855815982628357880533578879275971241960602157553803440025683287002227612374187450169424427029416768839411491319065615425415405581624092118690032922959286757782543899873851064199308448287771065503495136543485712053609703442124327418733025005846635244404006715921985235984677436543713654022215312823293168794113417578944926419927553777984011710378682215223875091822727471863742737413587849203293691679750416199350936776356984242118627270704272172055235070887565527381169522717633379285021343770590380283561582647287569346195426690664198548666980234910295696896711108316735851318530127033022203575654622173277938450152541615172627732490086846832553709112987616398422630679223939862103920905987987294036804514035993850214060338948178752992843184133039197014773670142310068261738336388263137160636667636443155786739812196252096736706725751006485215933041777068555759648517136358032522048989230899708131940555982675088156223655420134142329091683656088636460373618034502803773668127790771975836959545471232666373597355453368515909652147383171121461526857194196989424691684729107459673536341755046197603453497041732677929237021222684460601004781412845644358126502725112437777454560592124454800355450147261809814831280722007995427905045283740423260125705735469917230292719393612555440801031926059973809944522581868458072064559084454428827394890743394620347090769911092563021897489747463218599512944759226783854601892788462006744233859863911789611405466671013062913656818180091948965121733154567137705007399311785662087831370894186710419259069846856360127796591508480244220681349269734997268893673188516668119787038638111614619757751433069914391904833961926605382414690718570040859841533496907821231170415913050507639835389444813582711088776623975249888044795602152292593375831228779681987908277833012567042192946863446164246728901414479117921669075099662792039551330196486065339673393747604461370091053726185870102001580436704008882433220083387742471682392365784590860548602313573402063060654445092145900948895875840878260943989718419328642612701662661931777003243047318346231093973631427087606059956441570197131400993829152125043483183156417628178357714827793420507927024988434415925537662757904058008176047655126796429468610411555073878668465797935028378655677374218180660910883476274627990210900254695379549489530946100922783999875223754433647221493715225127218011530018208377672539273325275606560316792228847881855623085009667533228212782704471104885003259614785709790769935106267221737625836169984805747162086061241597464540056833819445645184216536544332564225970916713794842833368511409209657694505935040834829361698816953023062844108936560141965032774543651380493179962418229658185959603123900560227601354101895288098965651387172669245183094574546642334772282053668011386423756374527045997393518291406032343591700344029382592553699243585440476116336165729086913099620868657903207161383093052097037635503961677396781477191985654157516117602199496346804077601531814400858326461153759055743160373210716329542736053737456708189843509713475544525965765662239161329657060348898803529848722701860648711973180789919978579180615856922467973620525899048909941916415288217816458321058798017292297568365857695570421571736360981175969708290583331000229956218416100205281817628044964866663914275667210245416996006558938575517440765009932541534294046679827873995470114911371375775495772649631718169758913521456492694361520920849110945649418136558837611944780836485897198393404009299464962150715701967903073638271599634320550435991316472135635266842150285412227734540125681132273336200420530270534442318755277130855048185604654742791833027927477416864791734898893838632585210802317654380325204972408039262797193207236657691145668945414878592554513789116348210490795666236950968660931915188188652051688081418649509873098453981793395558506564572875655497494687506739594281904125683274816440718347071332178246326156759689642057501642723377290209310371232573654101996933224637677514646442965970298321825189112925194134077602030650135114017634604140233845552317992662856154419425531508109760256232745023852541452341028663733756379547988990430971935924624475231739546496780087572333294736673582985411593980717622613311255788436805856626354094668314854405670697020619671493766807418618430089282421507112344395425140412704153004830847321216810144448698904634617392859404491352959497723965586207260872657882374936068967650140085964667082204105014708558443030200798347919040614680556173489649525714310696790372924786270083285198313353340015686721607694755089854706879358404773821794076783012047447103206210921020436328441764174970901420272815084728298131987534674886501522630134255069021220193385820080315238064018859635486774962773161412119887232611453385429015047483932084340613862943285061567930328181537236260766812357702760361932160828802697350832076124832866730703866704918826109289370121382305845360167062557113087244159566291467446202578269059631984882545668589086435983061026517453267212809427222746583041138512039368776027517121517242575274406290429519362865321884022870237302368065936796858313607250005433570620483384104519534692394496697276607029099582279253262089659685690469159579459573199100598763999351608722697047320058301631642284698064813999661889441361452385113708772801801381373015623433875363310997939148827556830756109854418950700907786578402898770762745548250523183412555362890870370822766826210276742779747093883628356635875245489856082847797023235940813575816211205304757782918693626582528720999760977676628187115654574647153254371800343889184653526425379432970063727671156547517070968076756257169405909858287278093096412865917352726269704328926735449797569555547598431609016541491703157439593041295480742660434216825883489297491734763639409456074610429678952197951769400889863622811168268740637848888341689547783721766664947689418343582665935277784393376708092269146726002099489430852047228377676555944075605612912337057776310869285706847224692624550611967234467695170182805768861973611532901481717083219844486456601543237346390592508496001355378491706291097795655254910851497479970963425780414417080967209890588383343603791945602739214774577387922305743254700976361284900038637130671955778460060258138213072691340480856877518487458760510310090794672480590564944816291693");
  T _9 = static_cast<T>(9.0);
  T _22 = static_cast<T>(22.0);
  T val = boost::multiprecision::log(_9 / _22);
  compare(val, target);
}

template <typename T>
void run_just_above_half() {
  std::cout << "Test Log(12/22) : " << std::endl;
  T target = static_cast<T>("-0.6061358035703155432494662195844270270987161617544124693631933659996857087249330305955756261924840150847442158016094470462020446969071370172698297683987546925177515666689222942197799304696856132941887433735268775190124537677095497781741316807673689258839788271319894841541030309845912565224465858104579195016366772782704350070610281531953288841229629037776390117685173974279479992232484919232344995056248789989191618272975414589954822086301807722278171621418436284526690867094405503315583092994815774508628239114376467312761060243655007259813157728284883100261136889954070372096587316295749832686689638246316340667696720704006329084618195404009847839518270420445628303729673541679331739106677091319230073721150179989068608342043386757966602104485135320279905074813850981543921924859254098599424383732127143177984949032373288046649113033108645732767571206085169677619559658048516047572185720490310272683905762681524291361223764405088085052076698093635715228494457843869183890942699854723573443915837847155950667314856541301981733588911219677322557066738133215177621356605197786678879952008622178709729520915857834564730564093218300118942391494546122406676211031073047805968620296551652803227597597074811423596088227878511770002895382906371659150183219510943002116956855341627406326214007133055488034193839702787337911826510433471722118878169465260672753296075319077160255397001319602922791077746294468279444295684684251164212717515195127304247312896795920825365590055031026664876721051555306163055091036127687742757224217833961856545175816144971171377273288592911267665169987325612021110423155529004963952207483679740925240751127213090658442074925316037672881583907909818099429265787636550301280833645945361301102576862218268034127212743280450411061593007279476351354323499390707427988569829647859270210967136764402989288609387719958420262998109454839166764815448781924259815379792178594038931196798405667085608916137656132106848409722070064316034227547701197402374649884525303548218936116349117509181151007332099417164779916600198741096796386997410957357123611498365166308124905740097965165711782862411469757485311295824017933365934266340617339616728803260660150660091511294178587390201749569739889637400147865256973165987580186564557671630414806568396457325857385926797936229051451436515800031067655319676501314311067150318028364299639363062128140152131177954679935566944138541374125644086033440227151102420333716985277062764855136614968255902148842592268575763321775489923849915334121155499240603293687631914472723247716526199852962690379537379779992212420269103281602031360560423386248711122645785869303319318007744288509733587419330930019669434451285852592199137933244782686296773255937059959886581459343476578285641998934190937088211536632672028313512169926412937652957795465364952091399412696025887406396288539666417084533081850982600918938936567874004407962295504656197278070615111761942974766128742294729644768453077681698994477668110893305228789063705369578219389813846628651731100357889003699313944079327784226686942611247042760660461254804477278481918228779436219889826118597699042009666900149245184490631640886309006628527522776345509032731420780681871424052618826660502357688335918572159008637039317282084829417934644576141993230628330725275064682524009385192970383232846919125250654041243616040413857838580041721071354231346733456015118736849764094317650178603844696021697068404198047714802561769028787448695302727615690329150318280549407766642262471621639608106367292508294998646846793007861034946739146710527500557370060369348343935304520271135768244819073369375760515798055251300826031515929319328013050429471096111069392132139239094705615848169491258549110449700931343026083469761118249246288706622461645118992401786239054601600291318146385297563515228306720061589877359046641058237148170787924307879482221005614667099257214253438569806765012592433466024396735326458107477259149285629709686493673145698092213703822878510917902647080906668188351642426516506205307079104801026999529477659597131396952596708098867581467787846683526421344282109358348536978569124559263059259073999392156431892126760937859136397620888953884457506818936032106273439897976740398065167977592132697084232168235972665453825498333924355433963417165101482725602567956388100851803507601978274998270465314603588608820481931233563882522021937246909471838644248998999387735032199584515998152903730255077141617561179534157036578007114066395722574105812084581403338411744347395115966721267992382270061789533726415658634128195637206391580894414482129890841546624221401031514062685924684339174359888554976971788107668617203544044397616093491899947073678303100680561452785960381585539368870479705465932064647343412562556815434592932032182301006402736217849243388431392650776271357208596137421679079375703669627938335439719993224764755404939334486838932024451879294420025856424350669846047944091961625351759430240411147028880377770752490877937529831613581024419498709811706515802016904682879129741823602091252203078855987772908922379639676797456700208634230999247797537876388421141150097719534970697170123402189113138971182484841205523360309092326142410457977792716914259845602514596295820974986851509216096423545622161499186002448148861371594750202816268354028932337649123437250018653555987406819441803249560671725186042988321943511830938774703121814485432050055643645537219331051432896689025290077434716766644679807948635559816211837663922036533089019091737406060421833422151509635434681810578873607394519596915250931903695178850898666204072582065367689432929030230170992661869623616046710078927494287100602067644394013557792664090351681779564963755227839394099960295185457974855933328906306667379708701227969429752564413255735964923351586031561395812134337339109107514507985848999224364778087969431175228128633801081570170894544730380020313286369047919308808040992607564229349519832765102720645148793730346562089242011796770513465225018021027025444812697094940617756572877242385362317333080856342131682612137267098787581246148870776520220185960659948954938401391885814268104770241008717910475413576976790002229997073995146579401233503225302670627224213245880839066593978027979831618012203648006113443764319464137682817045138390490244096409973718624585209711986132470136990287607384681006276151051465188934464332377264243235982142217169364748182335562092045202430302748488164293975416388444196117555133899502782983095659465535645711122221486119730431131377046841645142161362561419968026203104392468677384269739772168286309344034594956900459480782687442307520101481500783082087308848520572233714611073071808851759794894472341692923779356180887236538607039611411160467207243237699249482918589938571519449146540313365021087111785844363257239537538780839542281771802024591910406445183541974127437603241106272560099285647869967749152227693764830050378142910109448155364762583116305648284683050048512015078340733322222136382420852306006799155283299555298842844376560930666128495076662605714273395938093263683636180271053652342011514019134889813386570524771644712979595473369576570898382057877405981091277244906371917353140001184302259029944043614070133724710599224114320172165173274704340783051877896281690706437323506547226201061362958410847330856871897973671072875289928233176916522809241718273088380803421981759190980961081981645188595126684039907672673682552420361405212747439492465235317228249929468876167037059275986095235753643425387637547204559700109422765559230548667725905494772393892708049250413723474354295646586161339322425868774879973004794398079773623361392099442750253906104587361254378384075444970515019005236949586869500031372973322573564502699174242465745587158885612599809214381671323566299537725778663890126188079867985869296240324581693410792712571576335462359187576799671218069372925418276520696931451923180982083682457367052710938090792960103941742405628103222855380088489067118520111671122618591995012071664829768460683556060504859830034652967236887140301955486841212948241676637025437571289900123309105552123105676110078342147925424637844383626517778291694224569940794011435931006377105670612614596204037157686755591248870261298466014480150691158834817743163711250175949201587054692719189525738858569231914784002627132482539153805395783469318618619883713974527804909297772767652836961824163687491924796058589182175881833880582986724340303656463638276281194439153672341829376055128208215397912522491975062630074345554088970071380422722110711512564471263723507887876415979669047631941393736162550038563944022416668151114990348520237151431805291198409518120670825934766859247224312136235964875118018473836732222956542851791780831413644098064283162632008216522115724928934662088754617848264997880876162435502198937523385064164757110362890582437315138855882903675245757568997216543277576022636983670632371320822516474628471697381353767327289837961838904087648581107236739508587994152222937630713418883540637945169581661748348797857703174321688686970508929562682818440616097128369880205967495099264911450869333902965898886738921199080969712195750302990291646373409279033520175141729954729984774791469100454100984517985213425146247477146693756402064909707829364684139869069897590036199242949992277225763717752549607878615849473631754914377958920592617575626638628052122928478846342167647507051048918667954921189786553114246667600178376847165152986875485431858389311704452271364812210181237459418037325200024208125128256750783440025257416336357042858208261021145855496795099229979885154590385277942803363682590879770036079957943203032256856517748268663401756769985300766542590947633546935188195216510537517527776574531557571601631697116038126133881001205314994051489423463386126223033013283496890832225261804218027528830901088142958951421244720650071954867912590429619690604940317875506212458517351719860796500209937355936701474380648808713773486002398537963017198034959584619492772385179704026029998989398242952699824375162198777137091689876075935101435781114105745943935623663558532183155837563807911148535");
  T _9 = static_cast<T>(12.0);
  T _22 = static_cast<T>(22.0);
  T val = boost::multiprecision::log(_9 / _22);
  compare(val, target);
}

template <typename T>
void run_just_above_one() {
  std::cout << "Test Log(12/11) : " << std::endl;
  T target = static_cast<T>("0.08701137698962976616776590187374954097678397260584278475748664349370791324476168501028770080393467245725726521896123868748347553885099353976284098323632126941297600415944914097052710815420606017693460674183762043622666670746313179675793347475736521364190412332101761117226361166951298263536836623328251088386412466590020666445761655964463928766158405324863261929602875282925940325838928146640405118963578934221811204642538749749806481713247132663187603982321492631203422008421388221607443565176882861857532319325229977494406169605902380363137217371770485514856770367709706659288752802729416092420264446917153864759811058447693357662385453724746668048811341937804036272376804840651289639742837591556363115102316367784457783327230921508477693153698069949198304132236656045836133668017466119361581150620201519149461899391866940098948156838920760758085313176037516468775792739893278877366917621067068832268030610021032984813654209479362783693600080252879636907427736233629881624589494021491743384286975004921642745493821363754588733673545182827641505589817852582246437896785927016273233541058408286622193793585065619355275295587260040001726693149418082719753776779330042287156770653867600932979677997854105176331538478647058048880816846204994990203281505806464245378291043072791242583885795507739121941362141179527188587039574365466941215637138580191658816040809931117958096583138076170170421253288463743297036044418325731801766397320836932443798423773918034748833893989885920585213650316111749860379757158062435462859399192341779211046418813419192174017258410574506594059189390849110713679685818211180202898424732138582954194693382810604029498039321264181022204844623988480953796983342315276008009822398546555800571536996484939577467392643867417348607741987459196030110930537222443319108307303558058654647233756948652681508554439633678287550401329534031477582459608561327472101340848482238126994934567313652549291053125340216334466897005598934804400438338724406149240895225171182515037335134502756178882064650728344481440176706167977101976685318403006096596623765514532226597164436430421755659529447908648894348498010380693691617661563263812373736730259047182536937945752506328502679440325494234781480541495855374184944227447875968646042464738863543485561981527399429908375193383771873381240709880566622228823816977567249524853837044979520677507049321508776569923779893989659200587492899734880992844322795819343183943649383806505444172035969716000654030721314869985112565748034073044174079272864436099142722544752000479478056619906130768797182096853462028403690538576077120248937740021376719091807936319042761366032512756370814148528230591955229205968440846666284159264125930960437235808882807976202457830572636225655458080509247759486840099498961496658677583186811767843792088358184183394762313371769598589828864051954319906959608681983573867075365704637481569823861574895929752056634462544644405189149880993758396073790607616246855592409587670799837267996526389279842281641098170662370471385438608065742515799711907635039324979129851697983643718279744116121143729685201095242664190062615692692510798971323929057593740151128371217040160583377029730279094034441105324317121435236505008849087555064389871472112673828437469924974125628979699468677274020029863780556899613195865922134729433112132299630933119208149619528189173027581537577341148848229449819482798898604789364592313800402237638674461624590693413496762026703316406151935122653759052362338384804215112570143128276383231313479979701855979071636299726998753361862342855643762334857316694025579633568960628438291492467542203167744487752081023045322603839207800289781141191733398709152680101004129675444368592060446380719501424212313289121387414478405371068575890331622203702057239991287125097557708931160457394589064416853445688980378417404825326536059424456831954424768422284613311068986385894424657984557991898887633306047375005497025599200724976773478416400433522916319126215644170511611908881857731156139585611470784224589969486859479090643342797121203942462588196664890792946515101936678118223607288423962793292961046763967673272019193553644431993208480791144329596109352960350179876126954312859973033466135620844792445127672772036271451580750254122701120807587434317923361506086576425431521238040074006218302298596668014595011328320071697904825613001159327039602627412483380684593246511520990366057845230565374670224151654542643210413528006389666396708674714363038966725722403413009756574953998383584435522980458338933234383952923546612478599397287986794399226316025628794558725407605064941363313525663423393577311088098910951380336670679893439791976914477241964357062346671259513431007208957286402245524903996367107904050445635757812485315929374025621073457864320738570973154018564057508447708004102700485303560941830248957731759446696123439670297224665351611479699966528896644927272301224340646034356399406380471851139283685305433546510013098201250788075679048207200144661140375996573314730826959664802537639216156161763728280808661405050632682788378900428036584890248414336652394171661295642790670978734767562888736211994730611291137811031782892249878591846792167983000342693552612402731394663082963990612592312902642618158661603082236686784099031284600083523011102702931720628350837637744625442584548545081522354881552107522572312246803910252784707986636910757380411637214924706332909205978266360727310069266505373347965954912168131550368303699716114369250194901518666489990920044915170755757202186868781119860322958096462038618794335807536121349042506026997166731171159585080966526741663344196668489068968975638283626284155134020963830434563627187925449167415684853049537864201786951170487267900128161869723244952663576179814630597487332801051915314347028451503969473098517641179264581914249336217247021611052642183536122697767330925608593897535680045769612233201055859209981914483155738812289158219689959545486898135520613354345570534247663149844165014994091175575279440827311030628978655700852537613460588579154293442651884054677311981527206727847270323178634505838830040935705392611178807958891789146559883131183051091802170312620693117582457128102070112437963059048149718054651801998011854882508649038357941025203076180827476799070755843456509659175741206721481331837598058904256049062744882932960332714442207686389574451045816918983459016186388654693152025708390815540824668868631671865872318127789725207853276771622015899976930957093336300289135338198875849207929579038924050516325692491687994266321320240590129873820094522913389347172914265762475647921869352354638249627238543679427437522402466940607972998727451928653753224054176842117209837101788369625132399852996775196574869483119551916930773438152963420837385647421209364319410440823827175662391562226570579574771097330138659833804670177544435338591410301887214764139835547756268009194013032591540833739602099573277490224666521161974934133103098447617358890706929084516497930347001368673109118550073439839535240199763571844491796103187787096735578358944481395339594145946066742586122733028541064067292027309235407152822506999408563587094071268509084734036473437611682004780209638944726710714215704914644643906111386374349534386223276468007432086858427807421174863844240965830490732048042071253323845177128090248122372445604547458339601013324323125799818755952141568353787045219182590009564290190110684150929240786047355543461006068244437157769471997604184888717538791076970758990328228133367081159416509788812685557881199604468789537459271071850645600663913730100426149643134876776768590966754066028325796464594380672052225942674625819093485454772732090557622551449910520698382290064682059544593422895880489333648270563095653015298610728555014480484355338767915209767280577982245169880010491350263922943727039814999215552121147518423284760276314098453600109242512942066587170203287666142448566736609893417275485019421975401860403130912208670246365666313278633025136596282624101044549798744766253709789159428756130098133292352113621294796940138606872156811897660727900303871495214877785654662298094011331943226058402383339454186114763321260324470790290314510291606162401123937384045089966957210444106560742963365455785314620784795518414179470541349628737352054227246567124303827781876917122190619694037107470834940332077740174785774599077983716364327580060355588213850710655497918444023023117836171049769641412133581402032169082641281572835479700081114884892164442385661862076846446975765083508079947042419088671766827511248398720596325794435923675440035811892233741839992181683874773199219585514876928839369433650891698266454838110067097649118395150456148059493457889484439859152532921840680108320296701007671687610231754291902778089344302117685931699407075068384331656348104236383283535458086018728004416137661541808581066190373774461472586327523597260263349994405837652992437600245217855697536133165780604532877408163881119598471038339325305225320983390432842130105596506704177324444966238234096222009925818119071023052309312825471321180252109629258974025419217433000833228933905690178753409644267707100942834082839520994998053170788257711825849197013030867558318158056074339088854298702935671051387235926682497623807277390918679662926552795465888060118494537082418981000334762699251901815108136903173863416527859412148284974851104212103722906159271883425338660157532961841663451958787907597226647403745049657947097680935086486991475830270014704061658923302652692063209760393070656649198156331081456065015482725166250648648801131749379075002827278006652526560340139368026485270255130614915226785010363974327810295747449195222688162965997517217113095581804373149082096221156393307521762341583590795421312555850907562533024783396079607336115199765566661083575602658343239830316888930173438760314507063298621881431215623484636307390842157988709005579276847250246543589565603254879493929937641108639395672074913557775222984129106071809233019749515746865924164414363727509324646564893130217939447006047477511157276130162175547640250875667700223663671634327575642927934485070256");
  T _12 = static_cast<T>(12.0);
  T _11 = static_cast<T>(11.0);
  T val = boost::multiprecision::log(_12 / _11);
  compare(val, target);
}

template <typename T>
void run_just_below_one() {
  std::cout << "Test Log(9/11) : " << std::endl;
  T target = static_cast<T>("-0.2006706954621511612714531041200778905267257382919182717491790418555850374760187793278231983751706138387756677562222670375195607067347477532496986492665532438453163683139123622307132702492163268615695231720954639531059823251315600060512566695165228432066915246380990187903631521330526275422252204808997721047704875676489448604306528359314734257852612080557124168419660951942589436514192564669079644524414283211993480535256033358759434049812307049663263626970766688254236246094151334489654810971990149857714458702062055880276804885105835998998458921436459583141848698209220970178986774609155538148522896196211245010740403341995100684018498670289910856355740060689543293111287032062033541212515707996359489264777641961447282034632848085538851172934267472207174973914118002752271973559458124900359813149037185615834055925599342047300188603236272408737215420589693505294468264320892449569240183438052170995482368513798490966329985418609902399267579277892528025850252784535926401576738606118525803326399871402891865985120639132403780996682898159055320851447448757817594274757780785678738724097807453396051273188540359517744679537974800793379430686218211181045792067954774266851481240602383083649061312062609296034439310634308529675548697538967544067287489318957359265502418444258712479970334971798909637215571046073506175556629471056089350921046980446154859983994592395912639997456369201438215411095493952451992273190027108428106979483202511537410423708674729307077857548213614902922716167458829070644122188549483486767164180054691600996844730386604626685777424513107561070159723340422831304326725447912885337258053169458244626487636228138242545356570773428505703953699051488652383103405354409047890682946052405521609950094711347023218072573287103853937759447146377635697138876823907387494491213323739912372394152387667490942358149353466517362599008033988006621831083354053899828782132147162242577094013122117029671551802750223237804517674088009088197672877448539555665788985618293231253561135535042182852306303793775477270969511999444922288822198911171088497215291429388150441679050467332662231453470268295542520857078214865048128081512348374463738044626660835159634391496535210067827348463765261960278974969135001374616719709727282247703540323489512695180455844047102553624120430408678310830176082074982108588604679010596420223895478641991058045236849109311645725514867158493064838795748180088708459471161485818342404079626337975590364639387634104036575295288228311287544528155706824049867460669952048845066537722781870429531467524116252481299859326212917184685312047340401527637240021207059662077994426586374073274455157196898720186688514246355386017026480232724925044591556954886960571738344038063978059646929668099112605096608924455969384285624308989412370278902396900822219738148809124048164576240151181065858162565079659308944940596606739858989920799810660369235363501641501047820246293950507103356105632994353160399729396566803079349295040650243774450135074734913530766238720845079308621820886547396341730167482682859487181283256484594807152587878069234896393801023041393550006109831787494092599657600704123359195957316056620615183620342820633921066096236276195646858595249897569346776387110372977979891712870180554653890069057121101101049031822512779705523059361171815943919437652302699471836844877362369584473587048242813094584319116957394849013421899966664330226672620535208842070091876214598658669686960704712430514834075940896885534261836321925990315958559724477444075539417240197349195616781223737994921470401079341571133535057411303566388488579057436139161256572566618110725659690164189245770812173940042564475857824191954840259516038623568480219345527712002379760173480879814942368205865271893369114175516032982404170082345577799314247833444539377932668267825853752147644664628794905461457810597457080178349502331568925710981127206173587413142842113232468763902305582895328100602724830515723677164973135098720681657878692100557742989771734349683023453132037342262007478327953228947076642172738127291922455166687547466632406354756540384711759777089353033167703845149446555397288815903979950988651289804570875633936459855500496723856505144893591971375382680401789627642744711477664816003843211719555655347442251102803153983993808888162300591503666295162724914929518589833837925298564497558336548275298777536435721290976126925737640481252390516748286915767445793367378390217278274935763716699050816185855046320485287674790126461610111471218153194762425193473823870306763603514588844061233161767670411952377305657110650591433809072652427468356928891291473483982788310464343330996445937873780529810509279959925413211372478632210553623064494049973731112332237232413539672380123264407115308992685259755795277836308872106994639351208952110616225020362580379904526453683753594793597546620808679677043499419049119814945715146617912127616305907586872932195506495518792830706497618846374764328671979424370394228623501909607796710181767692823623640852248306547300355486617074348295691453150008774397119719263599814396340372694755289106203793584849855078501728619146919547103360776299447035842320769145204084332788088293450987683843144109645640483852211248791041019094729171248529239585001367112249706781100709381877245757757956086225224135996063949481288810624981961436360801072866633048167315264270625890387775286264070722737808264137885095585337683299934275382408764208882021311835869052554821948937187451347313458720384114392672164766903337324531463084983858922502415327323138892397986491816245465744330891002105361026240268303708141472009037363883742418189827456715468123171469389822312615439574943072144720795317143394747193945337308821060297713706375731574137242649192690517390725744909655790000426866221904199658803269189156136431651775033910017019008546021663634723468698127474402648907812056962943347128789221462681931881043626171187596711201905372604720762894079682520989186138100029501189369194388709213116384537572033045314485618757747790940812261408052387118795314121094650496892508094392104077405084428963647750871269016651588451138497708613889657624246014655029988529845318829082989872313214201626378962174246402368698729821002978553235489704062892913827363621084787295542848162905407210985544485596415822185890414974443692589449574568798160271723767668144668941272098736334061479754838701251484750553174823631121028639661230076801627341367711962901707392725248129891732589676120199173663054788910219567368594552912249429766944554048771857455362080477730259338130114644400630304443551761179695048505512849369245321783354572246636138674231567722638154818174181604425219912085195964503568767877302516620026692372838583656936766308101352497794104503074941606265742478942544716426758914900807408323832309768354596515712832942496804825699102413453684062915815954994303280102700048081360717474060153895575606792559507511663919600573096066830807154046127842429538690553165102185484202685870288844911011148631102170703132927594773835780074152656764034310406507246886722486942073506103397576717917978141644259017577924018752584562938997130009389656029779553279395295041995719466357655697254155293444365564667143798485815867505186531085596153338530806239526850028149694254361425749838594118328142178040279538752848617449015183947840452748464143678503972910072807234706826773754828104158925519860634026707086846235642218212113959410128155776651065934387378127185758729701764609337929301989162560588013552296159838288541872705885569387111553926746250419770065270795348317376985186122103604322670364713361651948960209863269902246120727748731966961184527555159167483558780775088001150696900023264759133930531195363940918893491896537090424962573201322137748894897559908938272277174124461348267891051018045885724969202194493927417201535915875922620886087027029203940276619143183637868990224759516971649616031434173555839228614656736301235870942105050485157792388677874276225842811628648037908162485050308503642309232382462431879772012663895590649303878292801536789349790058517307641060180081255739935586166433501460153848832261155094385870397097351958420738393203732550566400889531315131362892736731498663097095686622649099052978185545653850385934414717812335727477532675344582490686252631561239253954714696003818678585434725574727682170486376663860327706502203102141999209949204362978796693797939484456757355777336542242710944076211282419903258211243235108673420223718996702138463517557637179069104707637333040466141956419857420690298142183523924571636507857817908559187911895492705091279983748327530148215771643248187693270521489639273556990448434461187227594292188334959617127347167784195068463154464483197883918335637310474383075821426234402016770831652832060223186522158404511424505254681139225415563501385480706110265745409457971523168530021245612772465237737614535235352981019267879665943811539126293731066253591392119625813038716776408989739204497668178818028910240142735839097704775542730136268264836198572605627179401242792880416557707558828124204099448426927767102028646281743671751793589847180788329898958601231112313297147750351597522912027804522181428719111541044113089515178992560127649301355976967407683107496924126909460669231801066200306788937749921122619886610935558776370225737642939996892815822776497736554315745912327613737095784192017141209256205038047695431589529848055129306420051191385321975039328934326288688188168496507842887498879341874234405962644119102667779872241066910608769109297781486840519907892457904755118841992557603271523063030632679193461655174041018221134468915650456827262026819274756315595087739018485483619988655435301280440323265932927900008075560850399586358683584147118241468386899897774693886641154878440303919771901509849578493034871220112783369635584395556052440125366568727072059332112935693263084326861125221888602092190136945057809107555789576437554025799593222032960195169828705045945048808462507227864140386856328180133040850533622787234604620954192429447993274999634982318418697221269143222827520999387653948054864280165099056567188708343456636132");
  T _9 = static_cast<T>(9.0);
  T _11 = static_cast<T>(11.0);
  T val = boost::multiprecision::log(_9 / _11);
  compare(val, target);
}

template <typename T>
void run_close_to_zero() {
  std::cout << "Test Log(1/12345) : " << std::endl;
  T target = static_cast<T>("-9.421006401779279877905877535594091488301624874281654668713547259141125829919014571578741425885493866737049512320495058678054729922331938358876598858798764732274579806051193799370571804698289359898757244319418660694727059382185420949872158750797015869951894743383619047253325069342440999094735143111563329214282292031651741444253835621400477079729454308219173627905885678231839613140679674107664555414253385341250001846981898110183667295644611859734177265794575593848619911222010116317579560625019867821095715006583433167059655185233324237075706527933372229349976918215921153638752044858602685276184465318619824207146909566308241221930991735260150883393282023762911070215314418114573394869226550500403352105842624856445661310587631749286886023845712337122020628366962826108964775187307824941279749009317224028536152409503801709044342909691263792135924661289048490112052602674643905568376714708040901424072897235303856521379640814086514917143278421233174647360396698801444915209348465446829367285670652351793652041194438167085067325263959628586385549675660730530980516080788383413042224120416786623382396647334896483210257594289878984689867028861558244448525363921323236696433001902862594653444092333729541723678325763332717275398335762406585998375565525284100458945562494798523316721339846132736374198566300896846122547978642271057803003831191459415428875917792272503991066678028609055663999907372702075435890021525204430691568836394834980386833306579395978693257742853526822662301961806315850814559345450117460191021983916826848356973957372275497476565586486732345802747958979304611143191337830518090408155410635752272336857569223044124100490830449320332239433839645436692152471637581185810948267743423017320633371534557292852002509397820746275003088411426113391692305489007505793191649176895153727577183755682394256264043694169426831418607505490824321387260745570929162550163882957868277825769399912247542474527857811550333511585517602779727343107347543083610306837238253107880544683095919822087335464587379553195482896862815362243512875510289486311225557907127811157692883640465664791559754262447347832697283286541708306122320150196985272092515749274787054446325192021086908666654132922541054059094392018439320316371638082626270832603831725313706638078653423851571058856804432857153697319953301488599639250369010163197452724845499718354788210947749569208813943706449659625810501648720482439831039637380079894698001410391351887442273040211249755265355526196658154711264100021738805576067362719793642152170694224687225618630201976693454782568944185084184978889871052104800259050482984230651400505655021022838149040236030566207891417151490997572345118601352297319195361957350861432809435161225698898569734161304697491144275196130016828061132916258540712849475249635602083343787038100860844999764222910417166907001088108618555514176407198238658097767653966082802574653175088583013984666529100760284769625102428502016517303208617458096488146997877841336081747638034296258397445227197095402125488050626191406382845706797847003000745622692579125749733428805497108468003638027975834808453214371690649007568132308479129509461631804073324778946875501613052458179794722981876353199756307521948878129653269900674684575924639523977197661832028872340091905291217391696460454312627991832574005521389330887887092215839283084639789309266089852327742716702942988127055122768683471402574830836507489200918512461741920202723233826314602642150522586796750438479455505977609736096788147572092026394897338743661677689153028583371619515255165438067404943883603669366915207187655828218829691100518366964680897517168103767848184979718177511119903040616112438612217460926791677944639003814606756233405236775156430744745085778146899969103772673865471086897026332940971126729702179047800454305808504356247375607197041893174824316837585588315943535646031186383015650992924645176101358723867383669036960239648316809390770317705512390302196384414895251772157521117212481792757092738501264969296465931168693407154691658607366076589415136068141287477883189019452990943408619662448557107790026537015036264541357619925037923634014778972969355970818145877408700471521868033405904871846789484799354747717739433691750887186791323007602081257979705197123381486975365028059188651348011103390084125969526653882063848144500532024315932570039608385109124791620329414283248046761681092185205118662373230782342392962317772819848256056291251967521105593521729875461826971145522655693612807292744674980751923568467980366097356297025972169527523712106263415573312880630631325980543301545409260349646565617935109444285683619005599229666776698593320219716343117711694341293828750208901472250371193237737794545486977914418578770793113396803802791190186827683708309031535590468076000905280627460082309992449641911257412074305854672358165682682323317270734046073923283842265475602382110510080583078473374294468440744618801381074374200950865962341867166919015133820296640535138413296663487907858749947174626123900460540624081570532793623437653144013450646403405111408586199593683120400710759122740484629464307545496885168123809254970691140903069013685459835780672756369444392105930709661151722160403388765876339472257540156930412885917573215466991562415675711616588215524601442445039014575769773382224646373508541279278307522967484216649205059272364171909939388621595641049355485296928528210966791267956014422070990962185586919055653659042069834108097715659561228024528139194643939471338910555745263185865623749732911588670446622409949657224892038285500507074356232283495576927510803411358420593980979323406417888079825264794423514778143942169598868487863165348092041864674283545872782399950616577660788303602713149898460558365777398403564671497855006721134185119630572838947419924553868610143606284441788953200601372567860401813426807013084691120782124883708534316150145815215304643622576964810890814107707175475568308275201143789667937380276478959989035277127693134746562677673935882265428243018439809057491518671557922948873681819286776819414130552886572168041327210823834652994277940421371068791661554591889107725735158428516678377035229667776519000256989239155443235995127318413648626382746222888779942117042965184562380352460673809758545370129551698318402007801924486586463842450236381992520388984509383277243989236577478803474138339346966008506946289664908521993432372557120135776479259925652038079535324431079526121461358669793547298802936985664388479986989015402224777100230626004674804526964200654226556478528989413060806488239781072984199395733841742507044869400395995836327319099605519492999400561646447245681761134263218943952627225635135114461300637444889465096111190922390171483858091590950135958410399019812079763406679865396360267649428592217589135176524197591245309634665707476166326624067104900888692161663332629712525485346901193285429265953304558397893065298326805837514005565482660867076919254283151214068821878156878772328964817887126143028337447453092736041686064022294001244873434168011627055984986483456801061697256498274863437676275052904246532886736257863292770167857084681894778685662000504000829447923886510090020386502824710010130476052381476130163477303922720966432504826106910302415425407589908013552184480634417704767652290609370538612860485154659840196075968875711495163935947102055829933160906604250296633834203803130847874102788595152643661381332151041007244704527519693405406070453534060082121469319800395885306437730715845007536647533828004378725752947759380549358546117013439594890033151217837518505077044638768334507445996461140224874200699769224866152276508484825777658381306075152047656756873995129184444104397084546432581572562112985947769260859279686198566186000333789568640152816913794317947550115635020980946370590650224255162148821431384186857155074218994782374922971442347745383147537966231277546343542985267291022807301042206203946327088185524459389928756013625615957754460329467550530331587815070895725038616814387237752750157035108202571856009706405621542022025459607981673288835803014783575651546751574887660323555879262442537731511638027295768933459954475534851790758788795120089018792703845621140689034154013446066579696808487757106134103046723435696780197065739779479804402431298770899342550864999685050779902608417305823054975636844465739768268835313392455696267529435094044364809476677313149419918203072163431302867097665924768015496632442986558300137748976908194030669509115280779656226571844984079527685518695751669774113614431069328069339128499362087377181325312985373465441684091138654280323933795858005703809771823175879084978349746484909753727428085729655024427283505536953278249004242492933000237139082461485525137666487893348379641005335779145978010326371976997252355286619675782511647144829413510051552553902144059182188303177845220020711176058133352532120196607481214468491016374930127973332576392604886915525819534213459701379920379633958360105639960851907468755474400206176031075117437054863536746756118971205025798647464026113769600811086200036386821346226802295344034899380535745841426235745365839885048066303791751123845081246956697173526710582809007421893055399848827176617746401525185269730234375653925203265806938582907333504274637555082127957387812035160633549248909815317689511950387837813079413097793844299769326925463702863399250882071941164207320327408571407617709988366517290597588585391737467648153630765750051346951356612441884398175527974971154474538369337711289418565531928641891651486523523372652559603000541510467086410144213272518598085656442865733575420151355696129040438855101912709904468825497215708678943769707365454260308341578652160030827251439643129077788276315398518061522180689918436326071979297948554250479884009639623668987517462172388198198013133671454018505330168906597132604746733646253109693075346972156383899986243260915298274976822034093408788943819317299431341027032293376030476429169894227493432752511490796563102889290661276138780237072820235955796031435138720715514769819113481461686270451953064203339424987279840576324977232213757162068338370");
  T _1 = static_cast<T>(1.0);
  T _12345 = static_cast<T>(12345.0);
  T val = boost::multiprecision::log(_1 / _12345);
  compare(val, target);
}

// N[log(1/132 + pi * (132 * i)^2 ), 10000]
const std::string answers[] = {
    "-4.882801922586370854291653057804008140620197680480677135194622061754855161071235111160397116809204255286688716995237235731994613856042568330473445764838537399516259817520799334149448444030082553515043934353212194427020999028728937197080207480892731788867968184384805891513416001958189710271964076688276366222873066420366623657915002351922880659721101080352850356944350753181363122775095829784080323088295122060045158743456062487702294944741341401049264770856670321530676544877763546834907690460298732728236315517350261548873795698197957626207695266929138839323378290706897436605910138251239563140660353703668516769999848817190711014010129275387229502784035421108795797980321668963623165029980411033930316879080433988188319433069685864689396106686158259242404271680089986976489828576384959867546601886904353376694243010372109032806660547785700142370879539552072864475543710569298292012246420757991225561429666943511384136395724914316626746487846631974048422996902529869655913668286863629740763681739053690264297929552173402834067355469655251429056762591909449690900125171898423021017893840256666619683051774231476715999280146342681936564361715864159825119499250233985505762438521814225672501249715140032538486559644108300612511247409127553568016853153035286142109379552738089744694171428487471564596980064611991528523701861170839506885700183105128890171442101833338443581147266685650559110842642359971298008784130658265835837097981557446158105686764397692536318595233876394380577516123558066609334236249095375269995316497873320125589092647509615620465526066500432831621063514734860586311457470244180404239235612916830238977038043665375079719490592161353488274718617716980796756641116154122231847021447473135726588648320656592001531525312160310425492109615767265355449577551008906630847372986231442366426656566781421527317843602286957347115398752433775305966609122782795001491614449737554688979285364465792890017375205841871854641169093118396375407869379607470318228606871755143318076303422697423379718562777643341662349638866188668863518506935735844853016087019188541114288022336320132927469255204631702512019241733912720889301959523106588219810920970662800623040547061527309754438414484921315138929942001084060639902400220512491234407552476577119889959173768246459726132284566348019156108640302467458945464670964525096912452335447960289312716007608375281441714829969721339657894714795865995134702503628375739757689954765572942038244965895563700944460550822958447655539773709642219666027395908623877823072925224621828486169758450365658095902762881254511753183679801961057332007887335536422991072914559330305909101140801809968750259009291492506118642577774968842982264634580983193507094701221239165236544766720658925578896605287955832818697347129350657702214839501239362147526706651739306601602283497270403203388600916433197153817911460643426117121450326211149943715842448193145215724165957851673218599175916924832887424346963644341359332754864124587291541050268812671983440658241667024046725194064296767308599215561072561418366788838922188749124400255173781863442307078995459335069176042586369414753537165451775800353128802254442031793323321363766955926619099345524225726447773174138459249769066002625184536922571211430429005040185685678347808560001079157299669252315933584483629435218730366921137410675380765895167962913036193315045388311437697314783279239762872827543037974658735160825570071196747974778786861183422638673582963660505574166020374094381226006246772508830016831551624557581621877307659976527578910765330269696468407305779679052663149527578853452808678178567559287144654730893772253963937180500627843912034229071625167822919436508716768552221027859653628682372300135779727096849204006564140991761558989279300724545007821875248174685544251055790674386888070695468292027417980399201995564483220110146252231406548911820822148733779487328094449742815327047964420721574050851140712542313361607870990121131518490483255343630664905711304758761948284503797666814318291773979496167538006138827314719908306930194173438802845278340285081135578100634650634037270335706734322096297751613096978395417169383103871875669398810610207711025730227960467562609623128515152093002766228089515049226517757544983946927367046950596290639612542010274632374991939815533855148447374935107698053960781878954786944114988011135289310170853490725196311464172481474297145678833534867706722858557852523475538886661982004136645711926830162874210991437545477516293316255846456444610275854761263249499757065711504346216518483738338518629372094609202748856878794977194136696507598668137214120592542949447123329857259744912782472722978371831654249463315049834094731603100712681886402914260293813494185291923521118239558875774196865216571112156959599760189652695305216824744538933901214920995884378639636054291312966161267222539278210863213628542898545145889638870488617633707315732680954593050108155862333476316856598271847238885133433416696104380874883261744337989674068344652092680136692775861849731607831568785801141275618806108557359777494765255653621506860873300976642350192530722639631004585448839286809051113390914238456760151019294959149415932544449561587783707381102196456957621417241575355420491586784798494201899677467865033707869949900359500143116442055350622104928218947147757984771841358724193595391202942907049408092638987611268720752804819342629367162764025230087523082700930012907153068247997900550387863148989372768492584105523316093012715644508803385676932658512296033190701438991487255340841481099891369164466770947749986059359870328111081231195465037697128813067566825947722887289615733030226887728648413753533368472614189203073316457767286644277998040965615596964925622688692958047921994642384344173925811871396986864466859593986483896076065398339467237298299436805909115958329268028622108108013845000143977741086810462012194854379082403173308009176003457249573129624617764217286266104532687911488434262310921826421764988259011772525551232593566496178519072126669306257115735051207201088122925514794017243257798416127786962757525999447775135077671078740250646282612547228725368489714764922826075915315768130302318567415248898477926192577039989978275218184382164030837076742112084984556056694980102904764976793988098395071477861227978846021131601936275152413312985300859192722854697136723359481722241689603511439572982533261729922948141282167187817360162100582336215898021696567660729599182767797345488342816137549539441070379928994355415627200508708885173883601304278588226681899981519520980735655169946278894863688151074276131655260900663479235319392964123497195567976169981049453750847626474902596404533139999696191334695653702770774236985706067932009709925236380444552290710009598092243229269969504924178285950220010903830305993433574304795031346359978626109567759293332718151507379572399201363366578549981943126734304981715841868524272422568952955138388293391805967187455621359910180025163694760873064216992644146759248426521325547297496102717880963667844273162659324176184895169756277490517034875593350712192592759762177656033901768644354608017943080021190974345126429201928114604477238275015781181269050641526862010904878179210963368467741544187502696683021926021183167809074457786240883173784200816765571061380211703861886740445773280156657736131068111553212882593893261639882709762182646098486091040933863007332433297789249554610478344436161734184124421758972959925133190533442592205126527830607123841971919749120683447077408463101424414493149664320209859636719598095496283326950045267593290678143142966389332526269027724802584141498871329324053945822902582341632405587121711558097723979857778397692677759761339891829630824338208541029292860486824828094441104293334574905841795085756287533084937390885577394548781105719972372233897449735493861457021857430437622426961523693446542038390301254160973848663215541920476256067897883250968145703482597563944257094339649058403415806023660967719206400079161655629458229292671157938943302686410748835398671286938096342859353820223389248908923817167126723625915742081792851411126187888059697499007549989511194982477075505538152510353057800926538250865433427479509266578291039807818729700828982316155309855330967161394202579217512252943371251750735068652127637720157312240728571901079363256071247138726717374410027731769426782046589628676827899982054632181260271638079583412816724203635605058868952598763582457352931356835848108077207143299653104635480145156425818315036306162608570318399503685452766512812129343272544879016997539911566325453603867466524430596257343344844332613918364703834905728687856748699792923305665028951394111503082834907559296258108165703828227659187976745803350801376788926638339154837790185002520949182286686379731314481293438664240913301218054258902483660196916814715320938291015461348581372156777467078818281220409676118466080721419791812189877283810786578695148703232441931476426565152674100575824103114203128330791568694359404192597762173056585154862848704459664945361615794134274967638633166336887771637857126532689924861232920756151677436326815396709990701266827984879785877506096949676895879423197021196532495399237057653306726546663621569265401165725697259205400172904890071679893745057359033868001175288529446630754031436219399258100932470787001385941013072440119645511077156216755057706961612842611394270938161116949728018796724776035784848154609813927346971587553703814741259930562506449400056147407402576692616249938385632331775881563166464592700244738908746776480629728702436372298906598286579692970126346727022765564266875963332989348260950413204666382785432621369867446035588505445883965775906747239159718492454907808304208171910526066807517484341189922321948115215173627041138835544745268097769436953736124770254555779055981548319494784678102435504283452965728203189662668860139964949677190357250507815050640079406557752005936839651195902523089565575456928987478131296233941058053047043397081333246884095264642793988204514917356026804375548363488014470725944691898073419609748922537257997387651590014455774361845114",
    "10.91033386941966052522174905161926573340334711553835536475459074897667490380103629999563052519443821728994082007929196750078819788658134305235910994669936357739740494266676552026846456712819744463841387562187607750135864081217771829785400493996719055903642962947751097214978623130200575987429822467500652126457991435472910694667437343410118594349853388515321995896548633527610144281004404060419734513208592154351833600261116357859469016278096663037517812868702697851520320551419113344148497370342236123508479431659526756120340334459387963758934832844786723319243242176800271097162106888396664946528904086864915795271890062806836881020989136105516657418433125311240257876461323965254805830423746633567633486885835926535512634457796046734476617024086022482775188932543868271682567383930138427618816205634763033679760835454742626926349084059839008347641706202217250258301710973498360108898470289258350772483470922539173863799498069612959019453811666469718192480781340593248020927927747379303878279376416083405724610078508444359892121401490154628395439349335714676997969397064854422304517618982426055006372657761897639447400533897286727967516485641910969466245792326289845366410148789840683227687662825333914490121986486193235006933780235600630133572294524069157889817025188577782855566593556583377126022350470876246127277854339590351015116441032018401220542596066082455732296831501388746130396847282527319929294957545419037548532089188109914269457195457899932246925153674666562280355180052524370354171049680105533029876262883919897086706346856601372167626744000827387220970512917915857412343839431803999066129044579095977561178532382840996934797643568576935451923278891898662046128041869732269294857549020677747650515166082991805195632505431892410898351578180299845451934737407306274626246196827686457205076780986901573679751778767547903363647800386979179387795964241098756977507138130586445728339309404442999225667651939687039036646319809661714497521668224554041159931851869361574369904067927554836185156621783134376572940577686126687759274357577636040461327095219627943757888733700434751328466095840176954592936332872362073104503869609955007208175703000176564163812274769971496645005558472581180827114377884935857371402449981926416842286394090532293729134387579280342765019842282838464320168724874158851912126977095604033216577545899423864974001579696749179152116974825637440140761748639052544069413272789503584932146558936836807431836234023696140627509718522785192703165381980269611545981035623856319132795778367223974233235542886118713563879768247126231893542200246777491142172599409680500503588042669160143978850218382545171915668786613293145201164679143331698536818557109941518317396917894615433817185790582229340980845265701541524971500747663026482332535550048399550275346125273553802174379345350413720180314702562054878227019469731210690255670815597349126618223403478989939094207565199594363644326290917728710377111620861800786952052771725010212130756163772931014462815802370107431989859723221896184807009486247949639105929543324005691958040363588252374833255022126280925325392064605090748068781658150088229863523767864075852635622825271697648228867266101526102799993892244218587782306412378557678619211168313940208949284911296354326210891070219351274627098869895617723578319020016865856093386217240001286191234592437659327203193991711803276348693044415057626836186823293981997958446421170302084166271682526615853672389060690850268536068990916372300468425625667043476405708338955705640675253300852408937016806667758076036367471734822314628359413580399755778083906633483873659483290393316658810496223515925472116813264300704777442748081785145433872850906027979137103443077530482740198106706616898740780970235469957233821708670723516051619113206437905335434341474996571204932649337389650489830876799645073770966441032885745086585166095459957148069568243000925442108205521642358399134361685413094380928579297814517979505679314386494454458799378589542296355868386703018460631249197216340537476700617746897643957395431254645348223877472065291723478672022949544623762856501573423445009196561300530847099381766982695067873486462259557405537031509431753708107379667782821686223198533731023097204079947070973247966092879052608678026365226091346508713074615394979764740248877780756484273000621062917919443767787591707459205913801123589069622921010143486544921235588947018301861022360132607788594931887599712806845081549774905607089021968623149562007381092604903129736664775092270200605317538160886227507838279873523023002922213499036650424885732005061212870436347178857437928723717416671205211660384409688919575035972702115058548417696594035878513764896563613253753650499124120517404535454198251510330791049270964894255297135744635187424038681358601072568229831747254709721880330780124486554614728126019338447226046592691924447443582393074622360360850562000260095369531640348318429252388609915056216651805532228556687335428730506328450489952670571469212331098896982574020740409154283655804777087629429562351623085365544013716893005482350017424859689770366952587871909436318574630406125969863541337999437876369981291832221391061568435077046861186236439798964958285630773809440461759989168047969871967955503997903173293003405871288649612907074449665121557263744464741466566836834389228659166965849834675391656144971945462440270792141866464665347657663655099957686915109216253872037796309129991825314257184954351457510412578021487399952869511304589430037134039235593924975351106731395416306842200165504499190739481233755373504843962833968325341033166428324507120336947465134298676445178878591570623867184598061067160940177950290954155796468916665912607028685004817683629216491674558188226314663563967400953342211073733581138041750356119761580079557481281082451641488887864490456543683574920728099205740045318023869917074586040071990920196025350127002024607079820649621309085159161070973067779332287654449133376596439981330204807226022033135613597682002046196152039950148803564974578058663105336792157200627301536159788687088985771981259821857927677810399589857373999314217724829596589139440416082847620454984308962076155834128945479759171603298884528142269641219396288015120453176187834632123867479782499599195168832917136163639862374888449994238444214861179510928337053462059904878915925992860733297457330711422002369982898206668879361429653642903113291899992001112194346953062491127642405830261761755363895573626337764697473475177798238480802944928438153088774913147649591555845360277721943387805792752260106822509235272656396889308371382052156737397850565997983437291127967192673132769117589530674068730877262053001372408792448436405602679077287851285996549524732377437642885595639626888040256730733824059796379114846484362538036443308140855649499344050135765148495367485986853087611149771420889257641096877323502910749714724372618251477474944508377168764711521953722127529669912735439261970286244272675515937886791921561966500321976819803037090597452007699132389538453722184766528844235643892629717826572203889981588443079256420866021419606858413640085082345327961934071628992832195081607222024508196731746157776017498563202003317945407631961685019843794833145505073888620885781963658742761329530861725331720892777057034092173391914295751480036671926480283212486872774319995081194140259031986902900915789010808554973291878542234464116497378671425290317209181931863815904022311582468046223110035847540041920214223414738012819895053457229298913510499237324442220535860205685906524749282338603540767165040190142929685332713046487858568330881498809972058487194191184397328471888478296664945505380581142140616148161658736389604302114649304305036552654444106728109586270360698161993136769654655725752476351272942344232910609202319920487948630072778118282074117119050297527094792221241456248327753771941399519611941053399323644866164255369381589043197811200517538955872940741776648493889660877166803200391943443526763023230191253675229165364364104007973463460406121016893538063122155062502770550267559194617722971047349395401013584127025499164211410256363565609298687985218928987471197448009465160143702326055771514698987849093545836395602481789063903143425359062502188126532186949192980679267632109162077116991810069886918128821912166778113455976362583039667374285999586599462783971420501768257930198458803736925843896567712194338119882515152695650030552311187637974638965745203214037904060391045999165669589229051935966974744803291861178062426585223808303691629867275166956541658660022264289931834447305147111303799661302192680601385067767637740952251434202562840268342317461873880203394389020756226562202212956044190329511393745290574917885809186702963460555130149914709544666652588391934470039180236059720342091889653727731832388653563792035098541857952289472446699209433944096418323332427040981751686090304209987451919811982395881775234246209832781846603324919816039046867538612731076885042866723424119110516600065377432870938457664084661359418674819377744878644202861124500402749513899344733641691723874582785253127811988090929966344957745476169146424644107265538460874244429211604239228814516804733661844469729523718450249699910430429421110604248311437362037337266836648105197183037845182639859925155504573386287278725721437680976753158644599339317719102872017264183316832992202898613310510816378290670996090315937805527771960815417243821140616757321166514818694333606430143919028306171013286495679268854332892654427100018508923732505655830049054289709536269982267777998324444936972352621865656544921869931044161341620024069172772421852611099334511239917093463584792387025090202330498060829815898618030065562155739989368566491298304415575275886125387860353170931405605932825996082546813857066240153434099880608513850568925315536108791234142523824247916031919718503380547685404000543553320482279088051390434901875936322494167736109914850799805455323523972332777034516531613917049075870495037374536526512672105466014953739218125177511892532059942895504714946372941285142872989291770038727075576402160957057",
    "12.29662812674141395786060237552678802695895057041198444799891898662816625083495066107991844857862938305708308061960993041033970865890215791331958203463166447389386328499058493999716692486959660445910619307688585525537774262213216831877059038780446375739499329117899234556981415960066789043957270398180364161121744286793625753554337504143750021647941896435839362331495675608606549798552940001708398264577229423922068185550553755745408551557533852314131911448756112681381926068909117868803403754745261694563769169756678365705004260481298392042803510732394487698824476638560942327405515835290276475639502074048434902937608528517404814612938560886447358829647839880353632841979533474527665556496686831009664757358279547449209242092867942961828158872391444911746776348436144057487287123220295023649188417441786384947799344958556564008631767600262174350898572559308274470023885107665941405256681945480656431347602104255527551941976348051952155338420630068468162976826746609900404286395827506941522152553396408326752885820518616558861113007983935300200285762493487228548967627951686471413764753172996054819571889801178607578247030304109668546442803974020838189785733631945878208409622183709019464060659616311103584717742574253808379276469127543495298006274879232847610126345741286780928897436962001192893340699202650024783620397231738140259777316173516826639805428904534165015456982680544522794334632856643232355989716716375820565892532236902519892396896465832994400954824067162914512361091613836039312136919254649372824841320480139537552778391682573432869975029768430889693804871419894641579630871311238890186450350061680020728836832756278732887090275878340171861435409136656252641917416758365402982084859399474466637209385025861487107810188618000413103815767937793060605864116617108249678793184625493261637813939195684265907892700397252455630334260638276408981229935533311222052618183680654050109163580026988334890747928594925372393740934143520770579741452873387512152030493719353771092345789130975636306338828447432871233678178790776617998915714439387636339709652915909507697811905201588012486539051613497040990994040693961246779750774492046905254360988446753685161001833390661410734613926162750054529160367950873279537711651512122129371725787642022630846610869490733602947843425139735179217053203005710079999682611487210669650603233269366955349550300995621301987335649242819335075716073397023495139564135508153735282377848785264580147229053770590685015557369942357143078195582477983670514470793932353266880378076368482365914311613036186366558210418216751838117875172009320841974445558168944766505932116972162102802570819668018499819346469587756928764774642295591584730782977807157918463936640692976014390955774959981585803476931589211707608747657348938710547331052389926402355891362070159940433928655183716460026868480949469447948633380824748821938280342670466108712751248958478401258388116137756400515068023287769959885916361675156429558371306420993234750765365988348858828422674629266535404341905899153544901957525080690161392922253399769088849709158751177011334562450836146763537642069221940126101092574695065430985422679829698254811241420596269315091930942796513956023034299278651069487836714328224656978034133069895781780123158094367909226952116365901922280763097491186195121839287665730293471002398984418880496496836022574583290183850021814310683924333528483023435293667461022234966390724244946096547972755993474030463890224500502042040545461910761060804647430804042355918433719840154445256144467202001095081414293739684490554890061667113620819756590238132526797965244425710819934623284100711355842315705719163277920960337143093986514001396511626729823976941879332722254649809884781347915378700680855811711361152853843101299091078584658179619903359051316785627060078638452853669110171342950822265637894899663932423179181135750448698792232201311397978110939536181829470222075857496496554447024168428852529808107112352757640691505309377309006152367847528538135880715617197924106711354972549979321618401387350169326233384410278287278888378751106451378334172355042811212684843586129118033675922273262162759448038564044620694703733175221203494182637656180893183762138935218402967490900520225703476807999629140803062438639987466167729167050765391121783267770842489815493589841221962804453208417706603062192456958259188469485225574259183209799078373396009556988516640345834008255941948648967985017038956575242616652758749559716267765002869072113072483027439910084606924539344778823307651619327470747646241625301948258771784548807103667548002116852085958699866960406110835303026814034379873088119137867205979627034822905115313027592977695093178561763526039616385478206855888046794270383461884273172500927451422198533315246386411650375244232964724484619558506033505890966203854613826222426615190925920596430146385613011250382609371229183890633588081426995811876493624323354120834380751341061048720077811075924646522394212023101082776373564825917125309773098670014840475760076222423348642900554418586017734965836758370525516486667685184164252385066732141654443601455003614665568022423225537112039905466086880796765948190523732762911593480577889086990664341395299027045211491540452491846712506734993351848181739318650937296863218574517787414503725938838759932246189652893635006578090355814840204096667238843233432717041746890409984333447363149049017103643615198622843758548603110071179969703194090424474297156085593988333690793696788806241529963997548026949388011476490747972584328163426246978441225608024899788279568876452528064254294108835878121242300305674408404598591538693412900105817017991322369646144876737509032848993272527819589607493936184208810779741404509412676882933961499982830822409837336855875265178253754632550854345145191981197913404541699931866550705819338278196642380137486729720951629075223109660605602806753361511045414240444901947728997080811946400080332257737875407474417880286785983257646448864581716798097194779141805689333447692933044809262830752278148892250787145837253694440156043212310816285500262566000872489913469935211919552526451227755415594571602303121593468861586170840507029722930363030724391927557242037783605010036013213733023833300947241430400831355312983235072288996274743923366083097427941759976493177154564087261372254399109333617104315752999656254472823661626345871603796257227217482765057692756086812052983465950392528833201256715768268928837696888409753944223222730556780054391039500664740586967615922094706817585842239779942532494637828417966386849596243446857443612874367904645249330920610564251568252143223727781944576312209562967858630475502846202096974554459739882527864484712936684297067524042319689113811187261781279341656626524651465064807205270277420209423723075267585409261353522592681579695204238359474285563998156844975215173165439792607060575217312739492850213562507978398444525154488624780843161429706081401587913941625057999889357804102078344665329869500525540454897092799117599332425198717856374769199507624220743948693203059123757132685066720284011992544901903191198338105945493198831431605869188510279583273984383067367389883792733565553766245594370192670220946088391019694815845684920611309252712899965043017836078834994170499893614027597867539250654249186262603386126589837426920636499513338473122927986119921217065561495211866264363269095448588519285278389184072076840223643708501970840659325811395264136013341178423979706970344791420705290989263351555616211068574721370963076486486381491974813091012660865374350093231187062634656367867058580040767613602691436535197460504061014914637678717629015394640739944161331886304117415291687353033875685050665853815001230249151846249645495567626925153708309236852324589693685151204844376135106368449258772393714723208700956125679165921533245486238131180142635228305671150168994459528652052583976649844327889336244212657611048573687403725069003002663537743126214454947027478310112891081423363539456681510733727996755547677277744361669351954750214188075151275301645065597373978004996885604445278503148097194048689273112897597143811309107071752139595137091128849379776597189109010620028318882264342383413529351848164673487617389637229348062888101832405475136992716561345601073167700897060040147475266580452396584142797430369969269814284550922224523432981956447646703543828588010850207740766347914093505390883750616962468527927188771877131826450095868650194516121663172357035299492438875524847644408133425741138843809915106325779312215552439880330447054741004052945530866063826823995945345296813272677950231450310813119527266507669441841789488847327141208096566290236783683443541296292745108985918999579602425359130635847613200221249508464907941641773090290600904146020168488239968272560157016374034158946009661915395533709146729916053353447919534538978808623671754600649635202504786734783497164337158784551219580324736925007972888982888490161738707912024833346043669885704376795390348303631798430360781435836711139343482530123280310720160580730764032511701093751740511365390885948953921947678628932689471084529471394846435297265395987045770489837452019069845545988666194679326956912894877975826638683073680930568263191021268057818378755640433837965770521354203781354684556440347023859306377564040148889794758967054758656113833741545677079092697674292718510644987217389307063641597506279061588684659028945857127859347353918423037132393993880262177186153859029396409470493938127832354467750158595211499075354908334033138124360965997177721390158505496894907744098268041267355024006731293067485825676383267783543133616399309438891201073556919449031745354974888103350059160311860181114999357211956425677976363166738877571680996668056860827075273196137115004016151680335398565095886464009396784008348746076507541760553185351562512469707390954657878152533283545083040997257818219408123529980449351277147318083985847482622411002163444878997849129187129254493944455110968983001714927563533937685517697910201072949404728878758920479248505096562033489592640834610159350088995234966168098631740553311428627030790582",
    "13.10755832373586428277587276659734184339641497621025480903392480428287563912597265453039918739942701115753076861304593553689781308733161554489511313276871613972604777879511748610172286961880800162743185587469373360961435576703188050164326768683776381822902927619647209339608279006136801163252698568080164259142872363139216326843014942482409454834864250935747187219140981069346533124069205582501050382153538858929223506202435878435597783117370770185896967752335903445243174434915861137505683166683866323167937103458522752434903166656930243553512253487841408702993501200859744794685864264012323183806373897488945517387111026294442562776023966378511732543624141205608110843808540351080570210684886939774822144198709626979750614991677989305418539857939320777540851728953886141444664485190959747832437927630324044730815118387638760167695444728113648963472810732781318740298514794086271441707303886127152211484308318189251727147815831064969675368572154922756758189398547173740961426210410576438673664230741484696915415398032777033659351051302866589225205571874998655062838881650255616702706396966921452408857700961376213754761602515669998643345886053956904078891827329651379082411948116367870042395119631427504443948393081415872605685757726246725878634773077509161638735142203315283386856772264031703478672701834321096454783274090388351649680832255022260127004003607305312046777995072220426726720846165692119277377589387276690076181344515256824687530448134365383827188653287896187896976049938418183182900007519011322063822940225692420469708346276511433641810989563920785016278255192966047797372339636794546901914886253228888848823084487107682461830074402650296508058683870054864750083895690931078940549211043030682735348826145824762863570645021132897462778352745911024051660696212947983702381054746730541469484723414749487712577365504829505270084249556035930519331184812482577887410016640070243470752411306425931951458339307295788268255945413684276765732461868364057433406997506454200302411513014525256970656660375790720023984191239889307321041660954944411988832938901900743102354158978894587209036443439391780984427435872151027534393617583952289054740762228675183800319910664726545057511262586669593070182061599419775017027682861239497405561663182799905933651379128414460235053295965767859602151893295861877966003122878016907840599983506467242290360242299158273009241962915269052053450036120259951981789621808987562344618669360094458095652077177831656592451473707136816996017293378620415028112617697344465620942549738562755919948148339341088565928876337541470842926490216624406415900295627775354094848008763572226174120835405746901557762661740605386068532422813625890823052379534431188325356511644493954343677952037345003703497138408496258994182140364064350205819632911050905770385873763076390609589640073910020523653821837046523393974683172951964330739543940539404876644834448125348061152270454366429138486137655263718844749133560662195458554210260008272015992431571527515700147729308430534016011940323847268031134119886702040608164421707969100285443762787427099924065713862136209975952502539074695383234080612149236507597871085163589275146075388552883052678209662641525774658130669985716145419583016020900054468356367093662314729641680193019972767500200772981581219770588485795719835770722806667010976064988193965247958663300396187148074419745842175147829073821362770041728697704290994159204798035281355696513978561693530096737029963857449844900563051341339475659831475233764221658644538485031864117016674608539563912856608968090905909548948073747911488977754452463570602747803292367251548081146286638609722227616813072080931964842204752833762430896091719884712706823922072816713660649295784570927663960172681821078525920287352647757551606290048386319540959408587166044669457192259338640375711902196299997265415337880859076812732170337341094751590763384632620192043956278037473980848450096971554658766030541855375042629238033262249413102249554936236714001855026686160811619513374135267504818744178590505611789998288518556264917319630989398793290132175177207393736763904650383206524071928026454913795300912199106456148361908217231980965971259897890462360053440011076435730070772848152609688153050494647797363521069003009665411502027472554601700999904534414864254546326464568455139908094245188283911263761110199925756857457042494880609969136745660373510241741694932282829318261075447611928778519042149347895253345143319928225814796663266750278416701643152473922242748499547398545193880480034655565535127367722883772938764118069219120019985159630208117050952978052931459756170913348398466191753147925184030844596071283005299588593943404144612767904429320806838728751262738974728693822034048217348816797123236260924287198594696695425298537567524088397027837976926433092080436147093139666752643375511646299017651848325923118332662280437821726068107385038988006420724226855150768496678253389232820717767359143592863303535520556823978290423282588928494994658487889824627463372705442960084002566386965339899729227599499781129671649763375323849620548283041957263445738273356990093273468691376255232898045401758177624267007343015668319004498097424229390385796945202468264454083636875567569890138797530973624495221200312404038816985576110958128470232794133636092736582218038113196406155639921432788133960479187494104729773004906312756650509979448365490958039928667995546986047881278520227908299455127402611691944613762986113802403510591437685728633405659785595935677513214683135915686647400658083251193534065752931244464859543475668746770460118933476973458273073098012048836454606269130416254615446196163356106987616409331598227878311868813667939933886934822872428039498051935960524900462338177766143271344197176025470018624285776426369950382476562596952742074992251920302037936671380761355993173568152508941347957513073122565471719882605096536442675858503879617314323937889460555046846899319269272956205485313740529388612963093249590954898529237861251261327329343090624369492016326051919080924629984673000151750657874786613020252059719676323310593660022600671764793929415908517680909676504775336331898442019719706742212786391234835777115284752264337480644101951458462578001653615084188574556098488349099906968024909416048438994658414859100812662274668316093216529176950571280797818101836979878914451811310674491379193517481625615099462427452332616303233336425927888227073465143144132592912943797292510309125976727932329429033541897878313487342038962781877516294521336881267218812724193329683791049505163145992246029764483345304031984534231295755535712660929018817131496323419320235704617376383924676384272045620617890038096563872747475370892832931276140558856245881346893579292974879499840091082176971877593728246155878515783514425495409681421078855910168365041507901686107626953266676607225694125394416698324462444609492719246978867801626786001449436558589165969870541199566162050447092191831134617157315025655682869086796780917642291337938928659243469851767792492109280698040456659652091754803234881065790880667699519716984698451557512327657311629872642216317533876085840223413164544742040490822634875777532170270518922717919655207693566368057136452423043010263140139859857764501922754847219763258575503684171459678217065948832353010950173094195973769211888603069312340948690132775467993881918994549945651808670596225462791503191349563766775101388662798541429499245418943437652161374015441981702788077044235172701326463271698608808158032722041792484338586557796145714504699183676276125040180827606396931108697530676545817239301764914384105906974469643172117930684993154043089586350521159762248480917857705042916607103719425932011905496549882449414350922815417848906524266890036685583156163743004292868401623733744425760756674887136689405176490723221407521952476046745140557111365844359775523743384399419939711989184309267125694651689193206318443168776574334894471380086558894267124556283783703488293362422756849796066287712745572927164131632589190334378445043211277944541245421702331753126369394339302844907233442591300462205455124910907067175387718292288868402582862731012820593579665672025276993872490702786515104712840628842036336441805323894957536614974032276049774528249649933013082157177248322801970696959262923608123518505201180902090684043400152571026056455280313876533673325522093714902715455433619259887403698124282474033076669455900745677190225043724405571185528337579149483052270400477817397810240365630438129253049303882540051131855719096096549988347007262553878734512460220291587564289284559441238725894431432302746116679191580172903247773232789517872653943950709765189595330927276787217785014922534874178073757482137267277506348000696156201107078426140589061038477173279417461222923858052534405945144628994917854563526144161853626031164641950292443471443142301821945113394615211283046692171803328405974594698087237654523780379868059001150483124987615051660407656413915047253723330343376910933245810168192818659640805975992335337436231574567950857113363066985230692115541965158934196096945112264313372042497191706583966640789791749738532161517889013233555044453475611652134857489175586350847834003902126460806402990215516158638636863396271125216601368059242410539630996044261031833831412519560338927877355837613713759112326133307700481922729670475962129355381224497456863716697373268870027310026631016416590013725386759212066490108904057411542319831064891079480685826603254019489908800525321275397738808883322727094762708895945425080199051495624434658867214165712952615565886334971372639200417955065189531295751992182023606988374990369834666352828759258268415391047075075887375802306068635830954661365973462722473033895963207443170434696616559942985767491942273606668859602469189349270107079797708030953863791864308729476161687270117951875518208722053714374805135542821942921925537038723968010923830801449931540767028657719841015912735299202239955170234646831607737560447492124951197434510481231585899355520841052241475038458949862503749073482225869477572296763905958395583979005457587925090873210",
    "13.68292246191176859670025099999682650951322512103772058855759401172660309779006721940920789006475551776065537403133977784824601940758470470969205644850229971039986572044922734324504097460207657068571887472030233938307919078503889414638987164726894371043467032734616134597155192890067127127554134418517393304916973699832981497613736841146423869911858817002227735833988235292214277160324996434719495870979670167638437063888944886603282969049575588898693790039038929339188530067377420730501539348707429483996646294764056106287902941629901498165891981379198746525652422136104273779072442787506808574911258882604419278282764344660920033607908521672845491090418325621256874312303402703637618364076128639071311628350400509204013150811185958027372381135531690469460719650852628519761003793594515938443110687438055351107107110970094661947063635766824730799288614028352030727128728721937823970320077711009617913837858185438101689351967749920444691691209319298914896610473320080525187160468769660654724751671742433230944716904820876539106236774488000411656186179927215809245434718409615245159370424371960275821426954693816100745228797442901212107766642906317307469838489001268421678801613899330247628341736217565955039483387955572602113616147267650399697977876248138828676621002632819039069503222173117128904139432833055542862419895431011423716819099915282545517271753774679298190627765578596412605969292181971626191783397520032698543555714712158199343109979719774361768310776055157305334432897603615305727193727973813417281016075075882478337956373858810318481908518854010755097969968338948581877867274353925209594368813821341133212890905095375118784755795366550545566399803498317877608910361802662592469345447112168876911918064497212584884986991805934252051624795182554118052756886884519716533000497864223772286802442569835609731720346150044099984244202048127458964164670442872477175413236375721888214165148757449172062884469993983967120462816570816081662363841196823053466409218423335322016183427551203270725281608609653573850936681666835035412590973511443499377173182107188154962938819104399056178016883686388357423985163975641844143417897377803422176187175621382055744278467227762790488518659195424043449114352295192740588719804416235594583966787188320708869749438512992036408714593554780890837970487765720206720181054008684016174381599130632191125094921844523827098293897155208931311615399979944895952804754547880260986585699728179118975729977608578186354288462826318495101433978024155044639828619164149207313344338697189325934356955866626366098785337948123226182349556420529293698979829720243526626558814769759011413489355667947658617427732216687819469935725320202908258026782310192782531200061918507588549224892072260539456919177574979354327936564819701106171140306196565582988653680705558436780543666858776270063382291420440180594293393302123157019765253842395687549456046791325141818274534518353920125354145875904371792137698085076732021196550448515602555152973403646014375560156158207733136173972527810520210028693863714530932347910199217488532671531191178000466728935425355948875911449792208101097247579735528998835277307425524133528274552031249093477488448309387489067516230382036460456124068909769790274269923677564087724992745200480939964974993817017821697040894116233682731326729510621583364919092988100784508495542573560368999047881647570119640617178935156404190864953713399888186795818554737925365219983797653929821902270308460442480603456547791979423517185012705473704115969284418106695867050230248499127146323850808632309341342277877987341542896513456071364496882902178949571156035902848558079940673106389845546992819312586910120960255183514782961458937682686442681968711252443900698185276180716123870885929344314713623142181292133087594162573896821688267751036469839127133068278219057015122088800433667765506839074687827669785477815280480423749899214765365444044416495953431899726534259876451558734553781552510494883152399540476865584101532095655463077582057143647023530082849066622036386046533731393739298670365401215801671535055287283593589041833936475749296487636585062508455997270359959108481263000780187938408001144341501539315629257651543977102403824424426048105248060893363321976507844507534406923806047375540721737581823114232380999831017157049903554792236354425018893711235724759071796289956659978355351940552768866742019363420010633431675844267178690946700762351439308809321743156882417903602570576388849602749297067268857672678877924547608565535046596578064544538500921158003151767971771375478833874415810209144390262317096123158484335671953518366866056750396593765326377374645432371158697874680168304444406890039539944436875067816493056286579241169359927660692635353354066226737224757356442929686819103449592948412428443324606415571218622000735192465817151144967018595115877549911001203789004358883833124739932668111900131963241265331538115292076364126865786923308833382546186726704509374679129788249948314945455199104743954949250631367379663752353428922803436918520265891127099350603963252912036528550853133126489574349047377432169059433401459096842581319877006187759188041351326519029123450513728055721204173321136116529165489102501246549938112915810653783029053821943493416181061531224935117453892144737220948567308464569624258020013449847681930662062784038193341267550557963800612950891065420886036668189270340759706863034998499491123271654200450378487253586072277542731509605171948554626700120837902516255066419820961461942573264462503460599292724833313251292048970422734265972397764700248919385966401248920905558911872958804100679992539000874151985454707926973512641002397238885906255218633299233992228114205147381285830606677649743293936441085119163061750838864307871736086864743395535156259767571652934944397617982166123714234305072205724638755222746895223580024287802891100676319817168985210774150178332408102043582799726631428542507276845886609444847881770060075966006471644028082921414307280415773486472534143760803935737156802752764865743582058857483899812806605177907685712337794185294731889922112449651500062165804861187493735963939410642543912882422842789827959211421987186262533359423732514126026217064541731986721296314880366457793563756927619994868450380293704724961715304731133419237361057191071859444579354503823898049105508800038870170792458281573887140736994316144308385364333920255993655984607482381108840080449256147543375652740488113285310388095069819404376849854750468486549668657106256874786621814152307987567097720944129908073714026073373471235433251211625939632742712669609723605027367246153161228612417008613156465834259771326942489250449253006993890699834828879122072841303305062258194705629384757899118729126774904160168288779095787261651023252401580135257606272672011888845115958446470494919305341603950409059127458565044955912315257101239476761770465924952471247625197442534424882698139989932774982592392947042226557289668982636440557535661348933731793840142582137155169231707518349708136697170700769115944031654933981471389809931297558296065496147227400383962764976223768737313558063438531667344405611712737438491729773176423134613104184013231731138145567472612970095783498474895961850543260487553059787222311426186139117576364899618175481389297468178959367201641779797351141188788184971834426041106037508121344021692598538346003957770398459583729370224034219180416227972723335153314954866937691143526026366885304463144982624176440511394495293699422873235746827952089749945467494119309727430372149228981365509973429220931185478964358676184566231627655937125952848054455054066676904791606660307747405997032021271432280071560557425503714709155531248730708076595135859534278540598977977162961392007724729489287628853711318156879723117251133965880581188395817658005827037608915543297651472818086154237400424273383357684828757947830047847473894355996257296632239674491996704090045077993713306177266200956063639744242638175245033850643578022781374657277308661307685283661892495478445207170034556587343497284034360653609806987702582168099774321118574276618688323629624681793613995976861607053666685594843722997701341202679248779023969132384158281309427774776208884196662454413029727014004650040490987052933386316781739684011254517876277838988788625836924983288315336075528130942449293867594357849321901375841284880818493089459484545096117104474505949417914526844631874996723959681355384084555380517161310551752569669221325697309159743479398401464969860774854052811671559229061168701406887152138683597503349984524237728462655593499458161755972656864148973589268720196070749257315032371285117964042430698929609685977823739803867507820697431329753410394187778628221530713319422696167999740382408640085218681602227430147456725977247136299614169000880926344144040289998643603242109182418282580856745573973753142283096459791681889247675280057491064398895187553980127989845501962177463047252184699405214679575546625828601903265515376874684593208717585259817192914410159089217133204947465255686080854192145912947343629119223990097516391948485370153299399659826462450093204522268000513002169643001361712334680129735076591370420445642676039074323013823937725102184560803283015059065056070048076437367956318024854393070944846241640024915258535877291109892367960380065120081182727044707098624200052570290712304272360264361685423951374628018466210752577745990476189973527348104973612248554506897262093407814463706397772019882786707342206455642949325418235686480314128922276539116712177788092836027758616691796897265152547308526970901015927370166305043848729572350641494091008771466461298451770571345306480971691783383621563719325125906885756600660223200288574505959839095426600463292514106776295839773827317352651177247688572550217943483939535296327127284452007764158754529645965323302971124237351487552093297818405607632370527984762861381737105845729134614529082956395231678040138152598295164705077215216858460329168775630220119920234775555916423366291448950599730039411739854370540803983649525289381124691451021440370443486358556672119228717386549050001435092410",
};

template <typename T>
void run_test() {

  // Test various pseudo-random values.
  int base = 132;
  T   pi = static_cast<T>("3.141592653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117067982148086513282306647093844609550582231725359408128481117450284102701938521105559644622948954930381964428810975665933446128475648233786783165271201909145648566923460348610454326648213393607260249141273724587006606315588174881520920962829254091715364367892590360011330530548820466521384146951941511609433057270365759591953092186117381932611793105118548074462379962749567351885752724891227938183011949129833673362440656643086021394946395224737190702179860943702770539217176293176752384674818467669405132000568127145263560827785771342757789609173637178721468440901224953430146549585371050792279689258923542019956112129021960864034418159813629774771309960518707211349999998372978049951059731732816096318595024459455346908302642522308253344685035261931188171010003137838752886587533208381420617177669147303598253490428755468731159562863882353787593751957781857780532171226806613001927876611195909216420198938095257201065485863278865936153381827968230301952035301852968995773622599413891249721775283479131515574857242454150695950829533116861727855889075098381754637464939319255060400927701671139009848824012858361603563707660104710181942955596198946767837449448255379774726847104047534646208046684259069491293313677028989152104752162056966024058038150193511253382430035587640247496473263914199272604269922796782354781636009341721641219924586315030286182974555706749838505494588586926995690927210797509302955321165344987202755960236480665499119881834797753566369807426542527862551818417574672890977772793800081647060016145249192173217214772350141441973568548161361157352552133475741849468438523323907394143334547762416862518983569485562099219222184272550254256887671790494601653466804988627232791786085784383827967976681454100953883786360950680064225125205117392984896084128488626945604241965285022210661186306744278622039194945047123713786960956364371917287467764657573962413890865832645995813390478027590099465764078951269468398352595709825822620522489407726719478268482601476990902640136394437455305068203496252451749399651431429809190659250937221696461515709858387410597885959772975498930161753928468138268683868942774155991855925245953959431049972524680845987273644695848653836736222626099124608051243884390451244136549762780797715691435997700129616089441694868555848406353422072225828488648158456028506016842739452267467678895252138522549954666727823986456596116354886230577456498035593634568174324112515076069479451096596094025228879710893145669136867228748940560101503308617928680920874760917824938589009714909675985261365549781893129784821682998948722658804857564014270477555132379641451523746234364542858444795265867821051141354735739523113427166102135969536231442952484937187110145765403590279934403742007310578539062198387447808478489683321445713868751943506430218453191048481005370614680674919278191197939952061419663428754440643745123718192179998391015919561814675142691239748940907186494231961567945208095146550225231603881930142093762137855956638937787083039069792077346722182562599661501421503068038447734549202605414665925201497442850732518666002132434088190710486331734649651453905796268561005508106658796998163574736384052571459102897064140110971206280439039759515677157700420337869936007230558763176359421873125147120532928191826186125867321579198414848829164470609575270695722091756711672291098169091528017350671274858322287183520935396572512108357915136988209144421006751033467110314126711136990865851639831501970165151168517143765761835155650884909989859982387345528331635507647918535893226185489632132933089857064204675259070915481416549859461637180270981994309924488957571282890592323326097299712084433573265489382391193259746366730583604142813883032038249037589852437441702913276561809377344403070746921120191302033038019762110110044929321516084244485963766983895228684783123552658213144957685726243344189303968642624341077322697802807318915441101044682325271620105265227211166039666557309254711055785376346682065310989652691862056476931257058635662018558100729360659876486117910453348850346113657686753249441668039626579787718556084552965412665408530614344431858676975145661406800700237877659134401712749470420562230538994561314071127000407854733269939081454664645880797270826683063432858785698305235808933065757406795457163775254202114955761581400250126228594130216471550979259230990796547376125517656751357517829666454779174501129961489030463994713296210734043751895735961458901938971311179042978285647503203198691514028708085990480109412147221317947647772622414254854540332157185306142288137585043063321751829798662237172159160771669254748738986654949450114654062843366393790039769265672146385306736096571209180763832716641627488880078692560290228472104031721186082041900042296617119637792133757511495950156604963186294726547364252308177036751590673502350728354056704038674351362222477158915049530984448933309634087807693259939780541934144737744184263129860809988868741326047215695162396586457302163159819319516735381297416772947867242292465436680098067692823828068996400482435403701416314965897940924323789690706977942236250822168895738379862300159377647165122893578601588161755782973523344604281512627203734314653197777416031990665541876397929334419521541341899485444734567383162499341913181480927777103863877343177207545654532207770921201905166096280490926360197598828161332316663652861932668633606273567630354477628035045077723554710585954870279081435624014517180624643626794561275318134078330336254232783944975382437205835311477119926063813346776879695970309833913077109870408591337464144282277263465947047458784778720192771528073176790770715721344473060570073349243693113835049316312840425121925651798069411352801314701304781643788518529092854520116583934196562134914341595625865865570552690496520985803385072242648293972858478316305777756068887644624824685792603953527734803048029005876075825104747091643961362676044925627420420832085661190625454337213153595845068772460290161876679524061634252257719542916299193064553779914037340432875262888963995879475729174642635745525407909145135711136941091193932519107602082520261879853188770584297259167781314969900901921169717372784768472686084900337702424291651300500516832336435038951702989392233451722013812806965011784408745196012122859937162313017114448464090389064495444006198690754851602632750529834918740786680881833851022833450850486082503930213321971551843063545500766828294930413776552793975175461395398468339363830474611996653858153842056853386218672523340283087112328278921250771262946322956398989893582116745627010218356462201349671518819097303811980049734072396103685406643193950979019069963955245300545058068550195673022921913933918568034490398205955100226353536192041994745538593810234395544959778377902374216172711172364343543947822181852862408514006660443325888569867054315470696574745855033232334210730154594051655379068662733379958511562578432298827372319898757141595781119635833005940873068121602876496286744604774649159950549737425626901049037781986835938146574126804925648798556145372347867330390468838343634655379498641927056387293174872332083760112302991136793862708943879936201629515413371424892830722012690147546684765357616477379467520049075715552781965362132392640616013635815590742202020318727760527721900556148425551879253034351398442532234157623361064250639049750086562710953591946589751413103482276930624743536325691607815478181152843667957061108615331504452127473924544945423682886061340841486377670096120715124914043027253860764823634143346235189757664521641376796903149501910857598442391986291642193994907236234646844117394032659184044378051333894525742399508296591228508555821572503107125701266830240292952522011872676756220415420516184163484756516999811614101002996078386909291603028840026910414079288621507842451670908700069928212066041837180653556725253256753286129104248776182582976515795984703562226293486003415872298053498965022629174878820273420922224533985626476691490556284250391275771028402799806636582548892648802545661017296702664076559042909945681506526530537182941270336931378517860904070866711496558343434769338578171138645587367812301458768712660348913909562009939361031029161615288138437909904231747336394804575931493140529763475748119356709110137751721008031559024853090669203767192203322909433467685142214477379393751703443661991040337511173547191855046449026365512816228824462575916333039107225383742182140883508657391771509682887478265699599574490661758344137522397096834080053559849175417381883999446974867626551658276584835884531427756879002909517028352971634456212964043523117600665101241200659755851276178583829204197484423608007193045761893234922927965019875187212726750798125547095890455635792122103334669749923563025494780249011419521238281530911407907386025152274299581807247162591668545133312394804947079119153267343028244186041426363954800044800267049624820179289647669758318327131425170296923488962766844032326092752496035799646925650493681836090032380929345958897069536534940603402166544375589004563288225054525564056448246515187547119621844396582533754388569094113031509526179378002974120766514793942590298969594699556576121865619673378623625612521632086286922210327488921865436480229678070576561514463204692790682120738837781423356282360896320806822246801224826117718589638140918390367367222088832151375560037279839400415297002878307667094447456013455641725437090697939612257142989467154357846878861444581231459357198492252847160504922124247014121478057345510500801908699603302763478708108175450119307141223390866393833952942578690507643100638351983438934159613185434754649556978103829309716465143840700707360411237359984345225161050702705623526601276484830840761183013052793205427462865403603674532865105706587488225698157936789766974220575059683440869735020141020672358502007245225632651341055924019027421624843914035998953539459094407046912091409387001264560016237428802109276457931065792295524988727584610126483699989225695968815920560010165525637568");
  T   base_reciprocal = 1;
  base_reciprocal /= base;
  T logten = log(T(base));

  for (unsigned k = 0; k < 5; k++) {
    std::cout << "Test  " << k << " : " << std::endl;
    T val = boost::multiprecision::log(base_reciprocal + pi * (base * k) * (base * k));
    T target = static_cast<T>(answers[k]);
    compare(val, target);
  }

  // Test some edge cases.
  run_just_below_half<T>();
  run_just_above_half<T>();
  run_just_below_one<T>();
  run_just_above_one<T>();
  run_close_to_zero<T>();

  // Test some special cases.
  if (log(T(1)) != 0) {
    std::cout << "log(1) should be zero." << std::endl;
  }

  if (!(boost::math::isfinite)(log((std::numeric_limits<T>::max)())) ||
    !(boost::math::isfinite)(log((std::numeric_limits<T>::min)())) ||
    !(boost::math::isfinite)(log10((std::numeric_limits<T>::max)())) ||
    !(boost::math::isfinite)(log10((std::numeric_limits<T>::min)()))) {
        std::cout << "Some max/min is not finite" << std::endl;
  }
}

template <typename Generator>
std::string generateRandomNumber(size_t digits, Generator& gen)
{
   std::uniform_int_distribution<int>    uniform_digit(0, 10);
   std::uniform_int_distribution<size_t> uniform_point(1, digits);
   std::string                           str;
   str += std::to_string(uniform_digit(gen) % 9 + 1);
   size_t point = uniform_point(gen);
   for (size_t i = 1; i < digits; ++i)
   {
      str += std::to_string(uniform_digit(gen));
      if (i == point)
         str += '.';
   }
   return str;
}

template<typename T1, typename T2>
void sample_and_check(size_t digits, size_t reps)
{
   std::default_random_engine gen(42);
   bool                       found_mistake = false;
   for (size_t i = 0; i < reps; ++i)
   {
      auto val = generateRandomNumber(digits, gen);
      T1   val1 = log(T1(val));
      T2   val2 = log(T2(val));
      T2   val1_converted(val1);
      T2   closeness = abs(val2 - val1_converted);
      if (closeness > std::numeric_limits<T2>::epsilon() * 1e10)
      {
         std::cout << "WRONG: " << closeness << std::endl;
         found_mistake = true;
      }
   }
   if (!found_mistake)
   {
      std::cout << "ALL TESTS PASSED" << std::endl
                << std::endl; 
   }
}

#define RUN_EXPERIMENTS(t, name)\
   std::cout << "Benchmark " << name << std::endl;\
   run_experiment<t<1000> >(1000);\
   run_experiment<t<2000> >(2000);\
   run_experiment<t<3000> >(3000);\
   run_experiment<t<4000> >(4000);\
   run_experiment<t<5000> >(5000);\
   run_experiment<t<6000> >(6000);\
   run_experiment<t<7000> >(7000);\
   run_experiment<t<8000> >(8000);\
   run_experiment<t<9000> >(9000);\
   run_experiment<t<10000> >(10000);


int main()
{
   RUN_EXPERIMENTS(test_with_boost::float_cpp_bin, "cpp_bin_float");
   RUN_EXPERIMENTS(test_with_boost::float_cpp_dec, "cpp_dec_float");
   RUN_EXPERIMENTS(test_with_boost::float_type_gmp, "gmp");
   RUN_EXPERIMENTS(test_with_boost::float_type_mpfr, "mpfr");
   
   std::cout << "float_type_gmp" << std::endl;
   run_test<test_with_boost::float_type_gmp<10000> >();
   std::cout << std::endl;
   
   std::cout << "float_type_mpfr" << std::endl;
   run_test<test_with_boost::float_type_mpfr<10000> >();
   std::cout << std::endl;
   
   std::cout << "cpp_dec_float<1000>" << std::endl;
   run_test<test_with_boost::float_cpp_dec<10000> >();
   std::cout << std::endl;

   std::cout << "cpp_bin_float<1000>" << std::endl;
   run_test<test_with_boost::float_cpp_bin<10000> >();
   std::cout << std::endl;

   std::cout << "Stress-testing cpp_bin:" << std::endl;
   sample_and_check<
       test_with_boost::float_type_mpfr<10000>,
       test_with_boost::float_cpp_bin<10000> >(10000, 50);
   
   std::cout << "Stress-testing cpp_dec:" << std::endl;
   sample_and_check<
       test_with_boost::float_type_mpfr<10000>,
       test_with_boost::float_cpp_dec<10000> >(10000, 50);
   return 0;
}